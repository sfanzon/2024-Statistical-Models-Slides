<!DOCTYPE html>
<html lang="en"><head>
<link href="../favicon.png" rel="icon" type="image/png">
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-html/tabby.min.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-contrib/foldbox/foldbox.css" rel="stylesheet"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.4.542">

  <meta name="author" content="Dr.&nbsp;Silvio Fanzon">
  <meta name="author" content="Dr.&nbsp;John Fry">
  <title>Statistical Models</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="../site_libs/revealjs/dist/theme/quarto.css">
  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css">
  <link href="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    padding-bottom: 0.5rem;
    margin-bottom: 0;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
  <style>
  .Conjecture {
    --color1: #f4cce0;
    --color2: #db4d92;
  }
  .Definition {
    --color1: #c6e6ed;
    --color2: #1995ad;
  }
  .Proof {
    --color1: #f1f1f2;
    --color2: #c0c0c1;
  }
  .Axiom {
    --color1: #f4cce0;
    --color2: #db4d92;
  }
  .Lemma {
    --color1: #f4cce0;
    --color2: #db4d92;
  }
  .TODO {
    --color1: #e7b1b4;
    --color2: #8c3236;
  }
  .Notation {
    --color1: #c6e6ed;
    --color2: #1995ad;
  }
  .DONE {
    --color1: #cce7b1;
    --color2: #86b754;
  }
  .Important {
    --color1: #f4cce0;
    --color2: #db4d92;
  }
  .Example {
    --color1: #bce5de;
    --color2: #21aa93;
  }
  .Problem {
    --color1: #f4cce0;
    --color2: #db4d92;
  }
  .Theorem {
    --color1: #f4cce0;
    --color2: #db4d92;
  }
  .Proposition {
    --color1: #f4cce0;
    --color2: #db4d92;
  }
  .Question {
    --color1: #f4cce0;
    --color2: #db4d92;
  }
  .Remark {
    --color1: #bce5de;
    --color2: #21aa93;
  }
  .Warning {
    --color1: #f4cce0;
    --color2: #db4d92;
  }
  .Corollary {
    --color1: #f4cce0;
    --color2: #db4d92;
  }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Statistical Models</h1>
  <p class="subtitle">Lecture 7</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
<a href="https://www.silviofanzon.com">Dr.&nbsp;Silvio Fanzon</a> 
</div>
<div class="quarto-title-author-email">
<a href="mailto:S.Fanzon@hull.ac.uk">S.Fanzon@hull.ac.uk</a>
</div>
        <p class="quarto-title-affiliation">
            University of Hull
          </p>
    </div>
<div class="quarto-title-author">
<div class="quarto-title-author-name">
<a href="https://www.hull.ac.uk/staff-directory/john-fry">Dr.&nbsp;John Fry</a> 
</div>
<div class="quarto-title-author-email">
<a href="mailto:J.M.Fry@hull.ac.uk">J.M.Fry@hull.ac.uk</a>
</div>
        <p class="quarto-title-affiliation">
            University of Hull
          </p>
    </div>
</div>

</section>
<section>
<section id="lecture-7-the-chi-squared-test" class="title-slide slide level1 center" data-background-color="#cc0164" data-visibility="uncounted">
<h1>Lecture 7: <br>The chi-squared test</h1>
<div class="footer">
<div color="#cc0164">

</div>
</div>
</section>
<section id="outline-of-lecture-7" class="slide level2">
<h2>Outline of Lecture 7</h2>
<ol type="1">
<li>Overview</li>
<li>The chi-squared goodness-of-fit test</li>
<li>Goodness-of-fit test: Examples</li>
<li>Monte Carlo simulations</li>
<li>Computational Example 1</li>
<li>The chi-squared test of independence/no association</li>
<li>Computational Example 2</li>
</ol>
</section></section>
<section>
<section id="part-1-overview" class="title-slide slide level1 center" data-background-color="#cc0164" data-visibility="uncounted">
<h1>Part 1: <br>Overview</h1>
<div class="footer">
<div color="#cc0164">

</div>
</div>
</section>
<section id="problem-statement" class="slide level2 smaller">
<h2>Problem statement</h2>
<p><strong>Data:</strong> in the form of <strong>numerical counts</strong></p>
<p><strong>Test:</strong> difference between observed counts and predictions of theoretical model</p>
<p><strong>Example</strong>: Blood counts</p>
<ul>
<li><p>Suppose to have counts of blood type for some people</p>
<table>
<thead>
<tr class="header">
<th style="text-align: center;">A</th>
<th style="text-align: center;">B</th>
<th style="text-align: center;">AB</th>
<th style="text-align: center;">O</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">2162</td>
<td style="text-align: center;">738</td>
<td style="text-align: center;">228</td>
<td style="text-align: center;">2876</td>
</tr>
</tbody>
</table></li>
<li><p>We want to compare the above to the probability model</p>
<table>
<thead>
<tr class="header">
<th style="text-align: center;">A</th>
<th style="text-align: center;">B</th>
<th style="text-align: center;">AB</th>
<th style="text-align: center;">O</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">1/3</td>
<td style="text-align: center;">1/8</td>
<td style="text-align: center;">1/24</td>
<td style="text-align: center;">1/2</td>
</tr>
</tbody>
</table></li>
</ul>
</section>
<section id="counts-with-multiple-factors" class="slide level2 smaller">
<h2>Counts with multiple factors</h2>
<p><strong>Example:</strong> Relative performance of Man Utd managers</p>
<ul>
<li>Each football manager has Win, Draw and Loss count</li>
</ul>
<table>
<thead>
<tr class="header">
<th style="text-align: center;">Manager</th>
<th style="text-align: center;">Played</th>
<th style="text-align: center;">Won</th>
<th style="text-align: center;">Drawn</th>
<th style="text-align: center;">Lost</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">Moyes</td>
<td style="text-align: center;">51</td>
<td style="text-align: center;">27</td>
<td style="text-align: center;">9</td>
<td style="text-align: center;">15</td>
</tr>
<tr class="even">
<td style="text-align: center;">Van Gaal</td>
<td style="text-align: center;">103</td>
<td style="text-align: center;">54</td>
<td style="text-align: center;">25</td>
<td style="text-align: center;">24</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Mourinho</td>
<td style="text-align: center;">144</td>
<td style="text-align: center;">84</td>
<td style="text-align: center;">32</td>
<td style="text-align: center;">28</td>
</tr>
<tr class="even">
<td style="text-align: center;">Solskjaer</td>
<td style="text-align: center;">168</td>
<td style="text-align: center;">91</td>
<td style="text-align: center;">37</td>
<td style="text-align: center;">40</td>
</tr>
</tbody>
</table>
<p><strong>Questions:</strong></p>
<ul>
<li>Is the number of Wins, Draws and Losses uniformly distributed?</li>
<li>Are there differences between the performances of each manager?</li>
</ul>
</section>
<section id="chi-squared-test" class="slide level2 smaller">
<h2>Chi-squared test</h2>
<ul>
<li><p>Hypothesis testing for counts can be done using chi-squared test</p></li>
<li><p>Chi-squared test is simple to use for real-world project datasets (e.g.&nbsp;dissertations)</p></li>
<li><p>Potentially applicable to a whole range of different models</p></li>
<li><p>Easy to compute by hand/software</p></li>
<li><p>Motivates the more advanced study of contingency tables</p></li>
</ul>
</section></section>
<section>
<section id="part-2-chi-squared-goodness-of-fit-test" class="title-slide slide level1 center" data-background-color="#cc0164" data-visibility="uncounted">
<h1>Part 2: <br>Chi-squared <br> goodness-of-fit test</h1>
<div class="footer">
<div color="#cc0164">

</div>
</div>
</section>
<section id="chi-squared-goodness-of-fit-test" class="slide level2 smaller">
<h2>Chi-squared goodness-of-fit test</h2>
<p><strong>Categorical Data:</strong></p>
<ul>
<li>Finite number of possible categories or types</li>
<li>Observations can only belong to one category</li>
<li><span class="math inline">O_i</span> refers to <strong>observed count</strong> of category <span class="math inline">i</span></li>
</ul>
<table>
<thead>
<tr class="header">
<th style="text-align: center;">Type <span class="math inline">1</span></th>
<th style="text-align: center;">Type <span class="math inline">2</span></th>
<th style="text-align: center;"><span class="math inline">\ldots</span></th>
<th style="text-align: center;">Type <span class="math inline">n</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">O_1</span></td>
<td style="text-align: center;"><span class="math inline">O_2</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">O_n</span></td>
</tr>
</tbody>
</table>
<ul>
<li><span class="math inline">E_i</span> refers to <strong>expected count</strong> of category <span class="math inline">i</span></li>
</ul>
<table>
<thead>
<tr class="header">
<th style="text-align: center;">Type <span class="math inline">1</span></th>
<th style="text-align: center;">Type <span class="math inline">2</span></th>
<th style="text-align: center;"><span class="math inline">\ldots</span></th>
<th style="text-align: center;">Type <span class="math inline">n</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">E_1</span></td>
<td style="text-align: center;"><span class="math inline">E_2</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">E_n</span></td>
</tr>
</tbody>
</table>
</section>
<section id="chi-squared-goodness-of-fit-test-1" class="slide level2 smaller">
<h2>Chi-squared goodness of fit test</h2>
<p><strong>Goal:</strong> Compare expected counts <span class="math inline">E_i</span> with observed counts <span class="math inline">O_i</span></p>
<p><strong>Method:</strong></p>
<ul>
<li>Null hypothesis: The theoretical model for expected counts is correct</li>
<li>Look for evidence against the null hypothesis</li>
<li>Null hypothesis is wrong
<ul>
<li>If distance between observed counts and expected counts is large</li>
<li>For example if <span class="math display">
  (O_i - E_i)^2 \geq c
  </span> for some chosen constant <span class="math inline">c</span></li>
</ul></li>
</ul>
</section>
<section id="chi-squared-statistic" class="slide level2 smaller">
<h2>Chi-squared statistic</h2>
<div id="Definition*-3.1" class="Definition">
<p></p><details class="Definition fbx-simplebox fbx-default" open=""><summary><strong>Definition</strong></summary><div>Global distance between observed and expected counts is defined as <span class="math display">
\chi^2 := \sum_{i=1}^n \frac{(O_i-E_i)^2}{E_i}
</span> The above is called <strong>chi-squared statistic</strong><p></p>
</div></details>
</div>
<p><strong>Note:</strong> We have that <span class="math display">
\chi^2 = 0 \qquad \iff \qquad O_i = E_i  \,\,\,\, \text{ for all } \,\,\,\, i = 1 , \, \ldots , \, n
</span></p>
</section>
<section id="chi-squared-statistic-1" class="slide level2 smaller">
<h2>Chi-squared statistic</h2>
<p><strong>Remarks:</strong></p>
<ul>
<li>We expect small differences between <span class="math inline">O_i</span> and <span class="math inline">E_i</span>
<ul>
<li>Therefore <span class="math inline">\chi^2 &gt; 0</span></li>
</ul></li>
<li>However <span class="math inline">O_i</span> should not be too far away from <span class="math inline">E_i</span>
<ul>
<li>Therefore <span class="math inline">\chi^2</span> should not be too large</li>
</ul></li>
<li>The above imply that tests on <span class="math inline">\chi^2</span> should be one-sided</li>
</ul>
</section>
<section id="modelling-counts" class="slide level2 smaller">
<h2>Modelling counts</h2>
<p><strong>Multinomial distribution:</strong> is a model for the following experiment</p>
<ul>
<li>The experiment consists of <span class="math inline">m</span> independent trials</li>
<li>Each trial results in one of <span class="math inline">n</span> distinct possible outcomes</li>
<li>The probability of the <span class="math inline">i</span>-th outcome is <span class="math inline">p_i</span> on every trial, with <span class="math display">
0 \leq p_i \leq 1 \qquad \qquad \sum_{i=1}^n p_i = 1
</span></li>
<li><span class="math inline">X_i</span> counts the number of times <span class="math inline">i</span>-th outcome occurred in the m trials. It holds <span class="math display">
\sum_{i=1}^n X_i = m
</span></li>
</ul>
</section>
<section id="modelling-counts-1" class="slide level2 smaller">
<h2>Modelling counts</h2>
<p><strong>Multinomial distribution:</strong> Schematic visualization</p>
<p><br></p>
<table>
<thead>
<tr class="header">
<th style="text-align: center;">Outcome type</th>
<th style="text-align: center;"><span class="math inline">1</span></th>
<th style="text-align: center;"><span class="math inline">\ldots</span></th>
<th style="text-align: center;"><span class="math inline">n</span></th>
<th style="text-align: center;">Total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">Counts</td>
<td style="text-align: center;"><span class="math inline">X_1</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">X_n</span></td>
<td style="text-align: center;"><span class="math inline">X_1 + \ldots + X_n = m</span></td>
</tr>
<tr class="even">
<td style="text-align: center;">Probabilities</td>
<td style="text-align: center;"><span class="math inline">p_1</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">p_n</span></td>
<td style="text-align: center;"><span class="math inline">p_1 + \ldots + p_n = 1</span></td>
</tr>
</tbody>
</table>
</section>
<section id="modelling-counts-2" class="slide level2 smaller">
<h2>Modelling counts</h2>
<p>For <span class="math inline">n = 2</span> the multinomial reduces to a binomial:</p>
<ul>
<li>Each trial has <span class="math inline">n = 2</span> possible outcomes</li>
<li><span class="math inline">X_1</span> counts the number of <em>successes</em></li>
<li><span class="math inline">X_2 = m âˆ’ X_1</span> counts the number of <em>failures</em> in <span class="math inline">m</span> trials</li>
<li>Probability of <em>success</em> is <span class="math inline">p_1</span></li>
<li>Probability of <em>failure</em> is <span class="math inline">p_2 = 1 - p_1</span></li>
</ul>
<table>
<thead>
<tr class="header">
<th style="text-align: center;">Outcome types</th>
<th style="text-align: center;"><span class="math inline">1</span></th>
<th style="text-align: center;"><span class="math inline">2</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">Counts</td>
<td style="text-align: center;"><span class="math inline">X_1</span></td>
<td style="text-align: center;"><span class="math inline">X_2 = m - X_1</span></td>
</tr>
<tr class="even">
<td style="text-align: center;">Probabilities</td>
<td style="text-align: center;"><span class="math inline">p_1</span></td>
<td style="text-align: center;"><span class="math inline">p_2 = 1 - p_1</span></td>
</tr>
</tbody>
</table>
</section>
<section id="multinomial-distribution" class="slide level2 smaller">
<h2>Multinomial distribution</h2>
<div id="Definition*-3.2" class="Definition">
<p></p><details class="Definition fbx-simplebox fbx-default" open=""><summary><strong>Definition</strong></summary><div>Let <span class="math inline">m,n \in \mathbb{N}</span> and <span class="math inline">p_1, \ldots, p_n</span> numbers such that <span class="math display">
0 \leq p_i \leq 1 \,, \qquad \quad
\sum_{i=1}^n p_i = 1
</span> The random vector <span class="math inline">\mathbf{X}= (X_1, \ldots, X_n)</span> has <strong>multinomial distribution</strong> with <span class="math inline">m</span> trials and cell probabilities <span class="math inline">p_1,\ldots,p_n</span> if joint pmf if <span class="math display">
f (x_1, \ldots , x_n) = \frac{m!}{x_1 ! \cdot \ldots \cdot x_n !} \ p_1^{x_1} \cdot \ldots \cdot p_n^{x_n}  \,, \qquad \forall \, x_i \in \mathbb{N}\, \, \text{ s.t. } \, \sum_{i=1}^n x_i = m
</span> We denote <span class="math inline">\mathbf{X}\sim \mathop{\mathrm{Mult}}(m,p_1,\ldots,p_n)</span><p></p>
</div></details>
</div>
</section>
<section id="multinomial-distribution-1" class="slide level2 smaller">
<h2>Multinomial distribution</h2>
<h3 id="properties">Properties</h3>
<p>Suppose that <span class="math inline">\mathbf{X}\sim \mathop{\mathrm{Mult}}(m,p_1,\ldots,p_n)</span></p>
<ul>
<li>Then <span class="math inline">X_i</span> is binomial with <span class="math inline">m</span> trials and probability <span class="math inline">p_i</span></li>
<li>We write <span class="math inline">X_i \sim \mathop{\mathrm{Bin}}(m,p_i)</span> and the pmf is <span class="math display">
f(x_i) = P(X = x_i) = \frac{m!}{x_i! \cdot (1-x_i)!} \, p_i^{x_i} (1-p_i)^{1-x_i}
\qquad \forall \, x_i = 0 , \ldots , m
</span></li>
<li>We have <span class="math display">
{\rm I\kern-.3em E}[X_i] = m p_i \qquad \qquad
{\rm Var}[X_i] = m p_i (1-p_i)
</span></li>
</ul>
</section>
<section id="counts-with-multinomial-distribution" class="slide level2 smaller">
<h2>Counts with Multinomial distribution</h2>
<ul>
<li><p><span class="math inline">O_i</span> refers to <strong>observed count</strong> of category <span class="math inline">i</span></p></li>
<li><p><span class="math inline">E_i</span> refers to <strong>expected count</strong> of category <span class="math inline">i</span></p></li>
<li><p>We suppose that Type <span class="math inline">i</span> is observed with probability <span class="math inline">p_i</span> and <span class="math display">
0 \leq p_i \leq 1 \,, \qquad \quad p_1 + \ldots + p_n = 1
</span></p></li>
<li><p>Total number of observations is <span class="math inline">m</span></p></li>
<li><p>The counts are modelled by <span class="math display">
(O_1, \ldots, O_n) \sim \mathop{\mathrm{Mult}}(m, p_1, \ldots, p_n)
</span></p></li>
</ul>
</section>
<section id="counts-with-multinomial-distribution-1" class="slide level2 smaller">
<h2>Counts with Multinomial distribution</h2>
<p>Therefore the observed and expected counts are <span class="math display">
O_i \sim \mathop{\mathrm{Bin}}(m,p_i) \qquad \qquad
E_i = {\rm I\kern-.3em E}[ O_i ] = m p_i
</span></p>
<div id="Definition*-3.3" class="Definition">
<p></p><details class="Definition fbx-simplebox fbx-default" open=""><summary><strong>Definition</strong></summary><div>The chi-squared statistic for multinomial counts is <span class="math display">
\chi^2 = \sum_{i=1}^n \frac{(O_i-E_i)^2}{E_i}
       = \sum_{i=1}^n \frac{( O_i - m p_i )^2}{ m p_i }
</span><p></p>
</div></details>
</div>
<p><strong>Question</strong>: What is the distribution of <span class="math inline">\chi^2 \,</span>?</p>
</section>
<section id="distribution-of-chi-squared-statistic" class="slide level2 smaller">
<h2>Distribution of chi-squared statistic</h2>
<div id="Theorem*-3.4" class="Theorem">
<p></p><details class="Theorem fbx-simplebox fbx-default" open=""><summary><strong>Theorem</strong></summary><div>Suppose the counts <span class="math inline">(O_1, \ldots, O_n) \sim \mathop{\mathrm{Mult}}(m,p_1, \ldots, p_n)</span>. Then <span class="math display">
\chi^2 = \sum_{i=1}^n \frac{( O_i - m p_i )^2}{ m p_i } \ \stackrel{{\rm d}}{\longrightarrow} \ \chi_{n-1}^2
</span> when <span class="math inline">m \to \infty</span>, where the convergence is in distribution<p></p>
</div></details>
</div>
<ul>
<li><p>Hence the distribution of <span class="math inline">\chi^2</span> is approximately <span class="math inline">\chi_{n-1}^2</span> when <span class="math inline">m</span> is large</p></li>
<li><p>The above Theorem is due to Karl Pearson in 1900 paper <a href="https://www.tandfonline.com/doi/abs/10.1080/14786440009463897">link</a></p></li>
<li><p>Proof is difficult. Seven different proofs are presented in this paper <a href="https://arxiv.org/abs/1808.09171">link</a></p></li>
</ul>
</section>
<section id="distribution-of-chi-squared-statistic-1" class="slide level2 smaller">
<h2>Distribution of chi-squared statistic</h2>
<h3 id="heuristic-proof-of-theorem">Heuristic proof of Theorem</h3>
<ul>
<li><p>Since <span class="math inline">O_i \sim \mathop{\mathrm{Bin}}(m, p_i)</span>, the Central Limit Theorem implies <span class="math display">
\frac{O_i - m p_i }{ \sqrt{m p_i(1 - p_i) } } \
\stackrel{{\rm d}}{\longrightarrow} \ N(0,1)
</span> as <span class="math inline">m \to \infty</span></p></li>
<li><p>In particular, since <span class="math inline">(1-p_i)</span> in constant, we have <span class="math display">
\frac{O_i - m p_i }{ \sqrt{m p_i } } \ \approx \ \frac{O_i - m p_i }{ \sqrt{m p_i(1 - p_i) } } \ \approx \ N(0,1)
</span></p></li>
</ul>
</section>
<section id="distribution-of-chi-squared-statistic-2" class="slide level2 smaller">
<h2>Distribution of chi-squared statistic</h2>
<h3 id="heuristic-proof-of-theorem-1">Heuristic proof of Theorem</h3>
<ul>
<li><p>Squaring the above we get <span class="math display">
\frac{(O_i - m p_i)^2 }{ m p_i } \ \approx   \ N(0,1)^2 = \chi_1^2  
</span></p></li>
<li><p>If the above random variables were pairwise independent, we would obtain <span class="math display">
\chi^2 = \sum_{i=1}^n \frac{(O_i - m p_i)^2 }{ m p_i } \ \approx  \ \sum_{i=1}^n \chi_1^2 = \chi_n^2  
</span></p></li>
</ul>
</section>
<section id="distribution-of-chi-squared-statistic-3" class="slide level2 smaller">
<h2>Distribution of chi-squared statistic</h2>
<h3 id="heuristic-proof-of-theorem-2">Heuristic proof of Theorem</h3>
<ul>
<li><p>However the <span class="math inline">O_i</span> are not independent</p></li>
<li><p>This is because <span class="math inline">O_i</span> is marginal of multinomial distribution</p></li>
<li><p>In particular the linear constraint <span class="math display">
O_1 + \ldots + O_n = m
</span> holds, which leads to dependence</p></li>
<li><p>A rather technical proof is needed to prove the actual thesis that <span class="math display">
\chi^2 = \sum_{i=1}^n \frac{(O_i - m p_i)^2 }{ m p_i } \ \approx \ \chi_{n-1}^2  
</span></p></li>
</ul>
</section>
<section id="quality-of-chi-squared-approximation" class="slide level2 smaller">
<h2>Quality of chi-squared approximation</h2>
<ul>
<li><p>Define expected counts <span class="math inline">E_i := m p_i</span></p></li>
<li><p>Consider approximation from Theorem: <span class="math display">
\chi^2 = \sum_{i=1}^n \frac{(O_i - E_i)^2 }{ E_i } \ \approx \ \chi_{n-1}^2  
</span></p></li>
<li><p>The approximation is:</p>
<table>
<colgroup>
<col style="width: 19%">
<col style="width: 80%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"><strong>Good</strong></th>
<th style="text-align: left;"><span class="math inline">E_i \geq 5  \, \text{ for all } \, i = 1 , \ldots n</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>Acceptable</strong></td>
<td style="text-align: left;"><span class="math inline">E_i \geq 1.5 \,</span> for all <span class="math inline">\, i = 1 , \ldots n</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>Bad</strong></td>
<td style="text-align: left;"><span class="math inline">E_i &lt; 1.5 \,</span> for some <span class="math inline">\, i = 1 , \ldots n</span></td>
</tr>
</tbody>
</table></li>
<li><p><strong>Good</strong> or <strong>Acceptable</strong>: Use <span class="math inline">\chi_{n-1}^2</span> approximation of <span class="math inline">\chi^2</span></p></li>
<li><p><strong>Bad</strong>: Use Monte Carlo simulations (more on this later)</p></li>
</ul>
</section>
<section id="the-chi-squared-goodness-of-fit-test" class="slide level2 smaller">
<h2>The chi-squared goodness-of-fit test</h2>
<p><strong>Setting:</strong></p>
<ul>
<li><p>Population consists of items of <span class="math inline">n</span> different types</p></li>
<li><p><span class="math inline">p_i</span> is probability that an item selected at random is of type <span class="math inline">i</span></p></li>
<li><p><span class="math inline">p_i</span> is unknown and needs to be estimated</p></li>
<li><p>As guess for <span class="math inline">p_1,\ldots,p_n</span> we take <span class="math inline">p_1^0, \ldots, p_n^0</span> such that <span class="math display">
0 \leq p_i^0 \leq 1 \qquad \qquad \sum_{i=1}^n p_i^0 = 1
</span></p></li>
</ul>
</section>
<section id="the-chi-squared-goodness-of-fit-test-1" class="slide level2 smaller">
<h2>The chi-squared goodness-of-fit test</h2>
<p><strong>Hypothesis Test:</strong> We test for equality of <span class="math inline">p_i</span> to <span class="math inline">p_i^0</span> <span class="math display">\begin{align*}
&amp; H_0 \colon p_i = p_i^0 \qquad \text{ for all } \, i = 1, \ldots, n \\
&amp; H_1 \colon p_i \neq p_i^0 \qquad \text{ for at least one } \, i
\end{align*}</span></p>
<p><strong>Sample</strong>:</p>
<ul>
<li>We draw <span class="math inline">m</span> items from population</li>
<li><span class="math inline">O_i</span> denotes the number of items of type <span class="math inline">i</span> drawn</li>
<li>Therefore <span class="math inline">(O_1, \ldots, O_n) \sim \mathop{\mathrm{Mult}}(m,p_1, \ldots, p_n)</span></li>
</ul>
</section>
<section id="the-chi-squared-goodness-of-fit-test-2" class="slide level2 smaller">
<h2>The chi-squared goodness-of-fit test</h2>
<p><strong>Data</strong>: Vector of counts <span class="math inline">(o_1,\ldots,o_n)</span></p>
<p><strong>Schematically:</strong> We can represent probabilities and counts in a table</p>
<p><br></p>
<table>
<thead>
<tr class="header">
<th style="text-align: center;">Type</th>
<th style="text-align: center;"><span class="math inline">1</span></th>
<th style="text-align: center;"><span class="math inline">\ldots</span></th>
<th style="text-align: center;"><span class="math inline">n</span></th>
<th style="text-align: center;">Total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">Counts</td>
<td style="text-align: center;"><span class="math inline">o_1</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">o_n</span></td>
<td style="text-align: center;"><span class="math inline">m</span></td>
</tr>
<tr class="even">
<td style="text-align: center;">Probabilities</td>
<td style="text-align: center;"><span class="math inline">p_1</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">p_n</span></td>
<td style="text-align: center;"><span class="math inline">1</span></td>
</tr>
</tbody>
</table>
</section>
<section id="the-chi-squared-goodness-of-fit-test-3" class="slide level2 smaller">
<h2>The chi-squared goodness-of-fit test</h2>
<h3 id="procedure">Procedure</h3>
<ol type="1">
<li><strong>Calculation</strong>:
<ul>
<li>Compute total counts and expected counts <span class="math display">
m = \sum_{i=1}^n o_i \qquad \quad E_i = m p_i^0
</span></li>
<li>Compute the chi-squared statistic <span class="math display">
\chi^2 = \sum_{i=1}^n \frac{ (o_i - E_i)^2 }{E_i}
</span></li>
</ul></li>
</ol>
</section>
<section id="the-chi-squared-goodness-of-fit-test-4" class="slide level2 smaller">
<h2>The chi-squared goodness-of-fit test</h2>
<h3 id="procedure-1">Procedure</h3>
<ol start="2" type="1">
<li><strong>Statistical Tables or R</strong>:
<ul>
<li>Check that <span class="math inline">E_i \geq 1.5</span> for all <span class="math inline">i = 1, \ldots, n</span></li>
<li>In this case <span class="math inline">\chi^2 \ \approx \ \chi_{n-1}^2</span></li>
<li>Find critical value in chi-squared <a href="files/Statistics_Tables.pdf">Table 13.5</a> <span class="math display">
\chi^2_{n - 1} (0.05)
</span></li>
<li>Alternatively, compute p-value in R <span class="math display">
p := P( \chi^2_{n - 1} &gt; \chi^2 )
</span></li>
</ul></li>
</ol>
</section>
<section id="the-chi-squared-goodness-of-fit-test-5" class="slide level2 smaller">
<h2>The chi-squared goodness-of-fit test</h2>
<h3 id="procedure-2">Procedure</h3>
<ol start="3" type="1">
<li><strong>Interpretation</strong>:
<ul>
<li>Reject <span class="math inline">H_0</span> if <span class="math display">
\chi^2 &gt; \chi_{n - 1}^2 (0.05)  \qquad \text{ or } \qquad p &lt; 0.05
</span></li>
<li>Do not reject <span class="math inline">H_0</span> if <span class="math display">
\chi^2 \leq \chi^2_{n - 1} (0.05)  \qquad \text{ or } \qquad
p \geq 0.05
</span></li>
</ul></li>
</ol>
</section>
<section id="the-chi-squared-goodness-of-fit-test-in-r" class="slide level2 smaller">
<h2>The chi-squared goodness-of-fit test in R</h2>
<h3 id="general-commands">General commands</h3>
<ol type="1">
<li>Store the counts <span class="math inline">o_1,\ldots, o_n</span> in R vector
<ul>
<li><code>counts &lt;- c(o1, ..., on)</code></li>
</ul></li>
<li>Store the null hypothesis probabilities <span class="math inline">p_1^0,\ldots, p_n^0</span> in R vector
<ul>
<li><code>null_probs &lt;- c(p1, ..., pn)</code></li>
</ul></li>
<li>Perform a goodness-of-fit test on <code>counts</code> with <code>null_probs</code>
<ul>
<li><code>chisq.test(counts, p = null_probs)</code></li>
</ul></li>
<li>Read output
<ul>
<li>Output is similar to t-test and F-test</li>
<li>The main quantity of interest is p-value</li>
</ul></li>
</ol>
</section>
<section id="comments-on-chisq.test" class="slide level2 smaller">
<h2>Comments on <code>chisq.test</code></h2>
<ol type="1">
<li><p>R performs a goodness-of-fit test on <code>counts</code> with <code>null_probs</code> with</p>
<ul>
<li><code>chisq.test(counts, p = null_probs)</code></li>
</ul></li>
<li><p>R implicitly assumes the null hypothesis is <span class="math display">
H_0 \colon p_i = p_i^0   \qquad \text{ for all } \, i = 1 , \ldots, n
</span></p></li>
<li><p>By default R computes p-value using <span class="math inline">\chi_{n-1}^2</span> approximation</p></li>
<li><p>R can compute p-value with Monte Carlo simulation using option</p>
<ul>
<li><code>simulate.p.value = TRUE</code></li>
</ul></li>
</ol>
</section></section>
<section>
<section id="part-3-goodness-of-fit-test-examples" class="title-slide slide level1 center" data-background-color="#cc0164" data-visibility="uncounted">
<h1>Part 3: <br>Goodness-of-fit test:<br> Examples</h1>
<div class="footer">
<div color="#cc0164">

</div>
</div>
</section>
<section id="example-blood-counts" class="slide level2 smaller">
<h2>Example: Blood counts</h2>
<ul>
<li><p>Suppose to have counts of blood type for some people</p>
<table>
<thead>
<tr class="header">
<th style="text-align: center;">A</th>
<th style="text-align: center;">B</th>
<th style="text-align: center;">AB</th>
<th style="text-align: center;">O</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">2162</td>
<td style="text-align: center;">738</td>
<td style="text-align: center;">228</td>
<td style="text-align: center;">2876</td>
</tr>
</tbody>
</table></li>
<li><p>We want to compare the above to the probability model</p>
<table>
<thead>
<tr class="header">
<th style="text-align: center;">A</th>
<th style="text-align: center;">B</th>
<th style="text-align: center;">AB</th>
<th style="text-align: center;">O</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">1/3</td>
<td style="text-align: center;">1/8</td>
<td style="text-align: center;">1/24</td>
<td style="text-align: center;">1/2</td>
</tr>
</tbody>
</table></li>
<li><p>Hence the null hypothesis probabilities are <span class="math display">
p_1^0 = \frac{1}{3} \qquad \quad   p_2^0 = \frac{1}{8} \qquad \quad
p_3^0 = \frac{1}{24} \qquad \quad p_4^0 = \frac{1}{2}
</span></p></li>
</ul>
</section>
<section id="example-blood-counts-1" class="slide level2 smaller">
<h2>Example: Blood counts</h2>
<h3 id="goodness-of-fit-test-by-hand">Goodness-of-fit test by hand</h3>
<ol type="1">
<li><strong>Calculation</strong>:
<ul>
<li>Compute total counts <span class="math display">
m = \sum_{i=1}^n o_i = 2162 + 738 + 228 + 2876 = 6004
</span></li>
</ul></li>
</ol>
</section>
<section id="example-blood-counts-2" class="slide level2 smaller">
<h2>Example: Blood counts</h2>
<h3 id="goodness-of-fit-test-by-hand-1">Goodness-of-fit test by hand</h3>
<ol type="1">
<li><strong>Calculation</strong>:
<ul>
<li>Compute expected counts <span class="math display">\begin{align*}
E_1 &amp; = m p_1^0 = 6004 \times \frac{1}{3} = 2001.3  \\
E_2 &amp; = m p_2^0 = 6004 \times \frac{1}{8} = 750.5   \\
E_3 &amp; = m p_3^0 = 6004 \times \frac{1}{24} = 250.2   \\
E_4 &amp; = m p_4^0 = 6004 \times \frac{1}{2} = 3002  
\end{align*}</span></li>
</ul></li>
</ol>
</section>
<section id="example-blood-counts-3" class="slide level2 smaller">
<h2>Example: Blood counts</h2>
<h3 id="goodness-of-fit-test-by-hand-2">Goodness-of-fit test by hand</h3>
<ol type="1">
<li><strong>Calculation</strong>:
<ul>
<li>Compute the chi-squared statistic <span class="math display">\begin{align*}
\chi^2 &amp; = \sum_{i=1}^n \frac{ (o_i - E_i)^2 }{E_i} \\
     &amp; = \frac{ (2162 âˆ’ 2001.3)^2 }{ 2001.3 } +
         \frac{ (738 âˆ’ 750.5)^2 }{ 750.5 } \\
     &amp; \phantom{ = } + \frac{ (228 âˆ’ 250.2)^2 }{ 250.2 } +
         \frac{ (2876 âˆ’ 3002)^2 }{ 3002 } \\    
     &amp; = 20.37  
\end{align*}</span></li>
</ul></li>
</ol>
</section>
<section id="example-blood-counts-4" class="slide level2 smaller">
<h2>Example: Blood counts</h2>
<h3 id="goodness-of-fit-test-by-hand-3">Goodness-of-fit test by hand</h3>
<ol start="2" type="1">
<li><strong>Statistical Tables</strong>:
<ul>
<li>Degrees of freedom are <span class="math inline">\, {\rm df} = n - 1 = 3</span></li>
<li>We have computed <span class="math display">
E_1 = 2001.3 \qquad E_2 = 750.5 \qquad E_3 = 250.2 \qquad E_4 = 3002
</span></li>
<li>Hence <span class="math inline">E_i \geq 5</span> for all <span class="math inline">i = 1, \ldots, n</span></li>
<li>In this case <span class="math inline">\chi^2 \ \approx \ \chi_{3}^2</span></li>
<li>In chi-squared <a href="files/Statistics_Tables.pdf">Table 13.5</a> we find critical value <span class="math display">
\chi^2_{3} (0.05) = 7.81
</span></li>
</ul></li>
</ol>
</section>
<section id="example-blood-counts-5" class="slide level2 smaller">
<h2>Example: Blood counts</h2>
<h3 id="goodness-of-fit-test-by-hand-4">Goodness-of-fit test by hand</h3>
<ol start="3" type="1">
<li><strong>Interpretation:</strong>
<ul>
<li>We have that <span class="math display">
\chi^2 = 20.37  &gt; 7.81 = \chi_{3}^2 (0.05)
</span></li>
<li>Therefore we reject <span class="math inline">H_0</span></li>
</ul></li>
<li><strong>Conclusion:</strong>
<ul>
<li>Observed counts suggest at least one of null probabilities <span class="math inline">p_i^0</span> is wrong</li>
</ul></li>
</ol>
</section>
<section id="example-fair-die" class="slide level2 smaller">
<h2>Example: Fair die</h2>
<h3 id="goodness-of-fit-test-in-r">Goodness-of-fit test in R</h3>
<ul>
<li>A die with <span class="math inline">6</span> faces is rolled <span class="math inline">100</span> times</li>
<li>Counts observed are</li>
</ul>
<table>
<thead>
<tr class="header">
<th style="text-align: center;"><span class="math inline">1</span></th>
<th style="text-align: center;"><span class="math inline">2</span></th>
<th style="text-align: center;"><span class="math inline">3</span></th>
<th style="text-align: center;"><span class="math inline">4</span></th>
<th style="text-align: center;"><span class="math inline">5</span></th>
<th style="text-align: center;"><span class="math inline">6</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">13</td>
<td style="text-align: center;">17</td>
<td style="text-align: center;">9</td>
<td style="text-align: center;">17</td>
<td style="text-align: center;">18</td>
<td style="text-align: center;">26</td>
</tr>
</tbody>
</table>
<ul>
<li><strong>Exercise</strong>: Is the die fair?
<ul>
<li>Formulate appropriate goodness-of-fit test</li>
<li>Implement this test in R</li>
</ul></li>
</ul>
</section>
<section id="example-fair-die-1" class="slide level2 smaller">
<h2>Example: Fair die</h2>
<h3 id="solution">Solution</h3>
<ul>
<li>The die is fair if probability of rolling <span class="math inline">i</span> is <span class="math inline">1/6</span></li>
<li>Therefore we test the following hypothesis <span class="math display">\begin{align*}
&amp; H_0 \colon p_i = \frac{1}{6} \qquad \text{ for all } \, i = 1, \ldots, n \\
&amp; H_1 \colon p_i \neq \frac{1}{6} \qquad \text{ for at least one } \, i
\end{align*}</span></li>
</ul>
</section>
<section id="example-fair-die-2" class="slide level2 smaller">
<h2>Example: Fair die</h2>
<h3 id="solution-1">Solution</h3>
<ul>
<li>Test can be performed using the code below</li>
<li>Code can be downloaded here <a href="codes/good_fit.R">good_fit.R</a></li>
</ul>
<div class="sourceCode" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a></a><span class="co"># Enter counts and null hypothesis probabilities</span></span>
<span id="cb1-2"><a></a>counts <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">13</span>, <span class="dv">17</span>, <span class="dv">9</span>, <span class="dv">17</span>, <span class="dv">18</span>, <span class="dv">26</span>)</span>
<span id="cb1-3"><a></a>null_probs <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">6</span>, <span class="dv">6</span>)</span>
<span id="cb1-4"><a></a></span>
<span id="cb1-5"><a></a><span class="co"># Perform goodness-of-fit test</span></span>
<span id="cb1-6"><a></a>ans <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(counts, <span class="at">p =</span> null_probs)</span>
<span id="cb1-7"><a></a></span>
<span id="cb1-8"><a></a><span class="co"># Print answer</span></span>
<span id="cb1-9"><a></a><span class="fu">print</span>(ans)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="example-fair-die-3" class="slide level2 smaller">
<h2>Example: Fair die</h2>
<h3 id="solution-2">Solution</h3>
<ul>
<li>Running the code in previous slide we obtain</li>
</ul>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
    Chi-squared test for given probabilities

data:  counts
X-squared = 9.68, df = 5, p-value = 0.08483</code></pre>
</div>
</div>
<p><br></p>
<div class="column" style="width:49%;">
<ul>
<li><p>Chi-squared statistic is <span class="math inline">\, \chi^2 = 9.68</span></p></li>
<li><p>Degrees of freedom are <span class="math inline">\, {\rm df} = 5</span></p></li>
<li><p>p-value is <span class="math inline">p \approx 0.08</span></p></li>
</ul>
</div>
<div class="column" style="width:35%;">
<ul>
<li><p>Therefore <span class="math inline">p &gt; 0.05</span></p></li>
<li><p>We cannot reject <span class="math inline">H_0</span></p></li>
<li><p>The die appears to be fair</p></li>
</ul>
</div>
</section>
<section id="example-voting-data" class="slide level2 smaller">
<h2>Example: Voting data</h2>
<h3 id="goodness-of-fit-test-in-r-1">Goodness-of-fit test in R</h3>
<ul>
<li>Assume there are two candidates: Republican and Democrat</li>
<li>Voter can choose one of these or be undecided</li>
<li>100 people are surveyed and the results are</li>
</ul>
<table>
<thead>
<tr class="header">
<th style="text-align: center;">Republican</th>
<th style="text-align: center;">Democrat</th>
<th style="text-align: center;">Undecided</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">35</td>
<td style="text-align: center;">40</td>
<td style="text-align: center;">25</td>
</tr>
</tbody>
</table>
</section>
<section id="example-voting-data-1" class="slide level2 smaller">
<h2>Example: Voting data</h2>
<h3 id="goodness-of-fit-test-in-r-2">Goodness-of-fit test in R</h3>
<ul>
<li>Hystorical data suggest that undecided voters are <span class="math inline">30\%</span> of population</li>
<li><strong>Exercise</strong>: Is difference between Republican and Democratic significant?
<ul>
<li>Formulate appropriate goodness-of-fit test</li>
<li>Implement this test in R</li>
<li>You are not allowed to use <code>chisq.test</code></li>
</ul></li>
</ul>
</section>
<section id="example-voting-data-2" class="slide level2 smaller">
<h2>Example: Voting data</h2>
<h3 id="solution-3">Solution</h3>
<ul>
<li>Hystorical data suggest that undecided voters are <span class="math inline">30\%</span> of population</li>
<li>Therefore we can assume that probability of undecided voter is <span class="math display">
p_3^0 = 0.3
</span></li>
<li>Want to test if there is difference between Republican and Democrat</li>
<li>Hence null hypothesis is <span class="math display">
p_1^0 = p_2^0
</span></li>
</ul>
</section>
<section id="example-voting-data-3" class="slide level2 smaller">
<h2>Example: Voting data</h2>
<h3 id="solution-4">Solution</h3>
<ul>
<li><p>Recall that <span class="math display">
p_1^0 + p_2^0 + p_3^0 = 1
</span></p></li>
<li><p>Hence we deduce <span class="math display">
p_1^0 = 0.35 \qquad \quad  p_2^0 = 0.35 \qquad \quad p_3^0 = 0.3
</span></p></li>
<li><p>We test the following hypothesis <span class="math display">\begin{align*}
&amp; H_0 \colon p_i = p_i^0 \qquad \text{ for all } \, i = 1, \ldots, n \\
&amp; H_1 \colon p_i \neq p_i^0 \qquad \text{ for at least one } \, i
\end{align*}</span></p></li>
</ul>
</section>
<section id="example-voting-data-4" class="slide level2 smaller">
<h2>Example: Voting data</h2>
<h3 id="solution-5">Solution</h3>
<ul>
<li><p>We want to perform goodness-of-fit test without using <code>chisq.test</code></p></li>
<li><p>First we enter the data</p></li>
</ul>
<div class="sourceCode" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a></a><span class="co"># Enter counts and null hypothesis probabilities</span></span>
<span id="cb3-2"><a></a>counts <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">35</span>, <span class="dv">40</span> , <span class="dv">25</span>)</span>
<span id="cb3-3"><a></a>null_probs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.35</span>, <span class="fl">0.35</span>, <span class="fl">0.3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="example-voting-data-5" class="slide level2 smaller">
<h2>Example: Voting data</h2>
<h3 id="solution-6">Solution</h3>
<ul>
<li>Compute the total number of counts <span class="math inline">m = o_1 + \ldots + o_n</span></li>
</ul>
<div class="sourceCode" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a></a><span class="co"># Compute total counts</span></span>
<span id="cb4-2"><a></a>m <span class="ot">&lt;-</span> <span class="fu">sum</span>(counts)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><br></p>
<ul>
<li>Compute degrees of freedom <span class="math inline">\, {\rm df} = n - 1</span></li>
</ul>
<div class="sourceCode" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a></a><span class="co"># Compute degrees of freedom</span></span>
<span id="cb5-2"><a></a>degrees <span class="ot">&lt;-</span> <span class="fu">length</span>(counts) <span class="sc">-</span> <span class="dv">1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="example-voting-data-6" class="slide level2 smaller">
<h2>Example: Voting data</h2>
<h3 id="solution-7">Solution</h3>
<ul>
<li>Compute the expected counts <span class="math inline">E_i = m p_i^0</span></li>
</ul>
<div class="sourceCode" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a></a><span class="co"># Compute expected counts</span></span>
<span id="cb6-2"><a></a>exp_counts <span class="ot">&lt;-</span> m <span class="sc">*</span> null_probs</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>Compute chi-squared statistic <span class="math display">
\chi^2 = \sum_{i=1}^n \frac{( o_i - E_i )^2}{E_i}
</span></li>
</ul>
<div class="sourceCode" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a></a><span class="co"># Compute chi-squared statistic</span></span>
<span id="cb7-2"><a></a>chi_squared <span class="ot">&lt;-</span> <span class="fu">sum</span>( (counts <span class="sc">-</span> exp_counts)<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> exp_counts )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="example-voting-data-7" class="slide level2 smaller">
<h2>Example: Voting data</h2>
<h3 id="solution-8">Solution</h3>
<ul>
<li>Finally compute the p-value <span class="math display">
p = P( \chi_{n-1}^2 &gt; \chi^2 ) = 1 - P( \chi_{n-1}^2 \leq \chi^2 )
</span></li>
</ul>
<div class="sourceCode" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a></a><span class="co"># Compute p-value</span></span>
<span id="cb8-2"><a></a>p_value <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">pchisq</span>(chi_squared, <span class="at">df =</span> degrees)</span>
<span id="cb8-3"><a></a></span>
<span id="cb8-4"><a></a><span class="co"># Print p-value</span></span>
<span id="cb8-5"><a></a><span class="fu">cat</span>(<span class="st">"The p-value is:"</span>, p_value)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><br></p>
<ul>
<li>The full code can be downloaded here <a href="codes/good_fit_first_principles.R">good_fit_first_principles.R</a></li>
</ul>
</section>
<section id="example-voting-data-8" class="slide level2 smaller">
<h2>Example: Voting data</h2>
<h3 id="solution-9">Solution</h3>
<ul>
<li>Running the code gives the following output</li>
</ul>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>The p-value is: 0.4612526</code></pre>
</div>
</div>
<p><br></p>
<ul>
<li><p>Therefore p-value is <span class="math inline">p &gt; 0.05</span></p></li>
<li><p>We do not reject <span class="math inline">H_0</span></p></li>
<li><p>There is no reason to believe that Republican and Democrat are not tie</p></li>
</ul>
</section></section>
<section>
<section id="part-4-monte-carlo-simulations" class="title-slide slide level1 center" data-background-color="#cc0164" data-visibility="uncounted">
<h1>Part 4: <br>Monte Carlo <br> simulations</h1>
<div class="footer">
<div color="#cc0164">

</div>
</div>
</section>
<section id="monte-carlo-simulations" class="slide level2 smaller">
<h2>Monte Carlo simulations</h2>
<ul>
<li><p>Recall the approximation <span class="math display">
\chi^2 = \sum_{i=1}^n \frac{(O_i - E_i)^2 }{ E_i } \ \approx \ \chi_{n-1}^2  
</span></p></li>
<li><p>Define expected counts <span class="math inline">E_i := m p_i</span></p></li>
<li><p>We said that</p>
<ul>
<li><span class="math inline">E_i &lt; 5</span> for some <span class="math inline">i \quad \implies \quad</span> approximation of <span class="math inline">\chi^2</span> with <span class="math inline">\chi_{n-1}^2</span> is bad</li>
<li>In this case we use <strong>Monte Carlo simulations</strong></li>
</ul></li>
</ul>
<p><br></p>
<ul>
<li><strong>Question:</strong> What is a Monte Carlo simulation?</li>
</ul>
</section>
<section id="monte-carlo-methods" class="slide level2 smaller">
<h2>Monte Carlo methods</h2>
<ul>
<li><strong>Monte Carlo methods:</strong>
<ul>
<li>Broad class of computational algorithms</li>
<li>They rely on repeated random sampling to obtain numerical results</li>
<li>Principle: use randomness to solve problems which are deterministic</li>
</ul></li>
<li><strong>Why the name?</strong>
<ul>
<li>Method was developed by <a href="https://en.wikipedia.org/wiki/StanisÅ‚aw_Ulam">Stanislaw Ulam</a></li>
<li>His uncle liked to gamble in the Monteâ€“Carlo Casino in Monaco</li>
</ul></li>
</ul>
</section>
<section id="monte-carlo-simulation-example" class="slide level2 smaller">
<h2>Monte Carlo simulation: Example</h2>
<h3 id="approximating-pi">Approximating <span class="math inline">\pi</span></h3>
</section>
<section id="monte-carlo-simulation-example-1" class="slide level2 smaller">
<h2>Monte Carlo simulation: Example</h2>
<h3 id="approximating-pi-1">Approximating <span class="math inline">\pi</span></h3>
<ul>
<li><p>We can approximate <span class="math inline">\pi</span> via Monte Carlo simulation</p></li>
<li><p>Idea:</p>
<ul>
<li>Throw random points inside unit square</li>
<li>Count proportion of points falling inside unit circle</li>
<li>Such proportion approximates the area of the circle</li>
<li>Area of unit circle is <span class="math inline">\pi</span></li>
</ul></li>
</ul>
</section>
<section id="monte-carlo-simulation-example-2" class="slide level2 smaller">
<h2>Monte Carlo simulation: Example</h2>
<h3 id="approximating-pi-2">Approximating <span class="math inline">\pi</span></h3>
<p>In practice, we do the following:</p>
<ul>
<li>Draw <span class="math inline">x_1, \ldots, x_N, y_1, \ldots, y_N</span> from <span class="math inline">{\rm Uniform(-1,1)}</span></li>
<li>Draw <span class="math inline">y_1, \ldots, y_N</span> from <span class="math inline">{\rm Uniform(-1,1)}</span></li>
<li>Count the number of points <span class="math inline">(x_i,y_i)</span> falling inside circle of radius <span class="math inline">1</span></li>
<li>These are points satisfying condition <span class="math display">
x_i^2 + y_i^2 \leq 1
</span></li>
<li>Can estimate area of circle with proportion of points falling inside circle: <span class="math display">
\text{Area} \ = \ \pi \ \approx \ \frac{\text{Number of points } (x_i,y_i) \text{ inside circle}}{N}
</span></li>
</ul>
</section>
<section id="monte" class="slide level2 smaller">
<h2>Monte</h2>
<h3 id="plot-of-1000-random-points-uniformly-distributed-in-unit-square">Plot of 1000 random points uniformly distributed in unit square</h3>

<img data-src="lecture_7_files/figure-revealjs/unnamed-chunk-3-1.png" width="960" class="r-stretch"></section>
<section id="monte-carlo" class="slide level2 smaller">
<h2>Monte carlo</h2>
<h3 id="implementation-in-r">Implementation in R</h3>
<div class="sourceCode" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a></a>niters <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb10-2"><a></a>total <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb10-3"><a></a>in_circle <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb10-4"><a></a></span>
<span id="cb10-5"><a></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>) {</span>
<span id="cb10-6"><a></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>niters) {</span>
<span id="cb10-7"><a></a>    x <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>); y <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>);</span>
<span id="cb10-8"><a></a>    <span class="cf">if</span> (x<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> y<span class="sc">^</span><span class="dv">2</span> <span class="sc">&lt;=</span> <span class="dv">1</span>) {</span>
<span id="cb10-9"><a></a>      in_circle <span class="ot">&lt;-</span> in_circle <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb10-10"><a></a>    }</span>
<span id="cb10-11"><a></a>    total <span class="ot">&lt;-</span> total <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb10-12"><a></a>  }</span>
<span id="cb10-13"><a></a>  </span>
<span id="cb10-14"><a></a>  area <span class="ot">&lt;-</span> in_circle <span class="sc">/</span> total</span>
<span id="cb10-15"><a></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"After %8d iterations area is %.08f, error is %.08f</span><span class="sc">\n</span><span class="st">"</span>,</span>
<span id="cb10-16"><a></a>     (j <span class="sc">*</span> niters), area, <span class="fu">abs</span>(area <span class="sc">-</span> pi)))</span>
<span id="cb10-17"><a></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="monte-carlo-1" class="slide level2 smaller">
<h2>Monte carlo</h2>
<h3 id="implementation-in-r-output">Implementation in R: Output</h3>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>After    10000 iterations area is 3.13200000, error is 0.00959265
After    20000 iterations area is 3.13220000, error is 0.00939265
After    30000 iterations area is 3.13026667, error is 0.01132599
After    40000 iterations area is 3.12860000, error is 0.01299265
After    50000 iterations area is 3.13176000, error is 0.00983265
After    60000 iterations area is 3.13313333, error is 0.00845932
After    70000 iterations area is 3.13388571, error is 0.00770694
After    80000 iterations area is 3.13565000, error is 0.00594265
After    90000 iterations area is 3.13680000, error is 0.00479265
After   100000 iterations area is 3.13720000, error is 0.00439265</code></pre>
</div>
</div>

<div class="quarto-auto-generated-content">
<div class="footer footer-default">
<p><a href="../index.html">Homepage</a> &nbsp;&nbsp;&nbsp;&nbsp; <a href="../license.html">License</a> &nbsp;&nbsp;&nbsp;&nbsp; <a href="https://www.silviofanzon.com/contact">Contact</a></p>
</div>
</div>
</section></section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="../site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="../site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="../site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="../site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="../site_libs/revealjs/plugin/search/search.js"></script>
  <script src="../site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': true,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'fade',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        text: function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>