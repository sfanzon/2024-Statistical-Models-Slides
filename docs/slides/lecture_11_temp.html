<!DOCTYPE html>
<html lang="en"><head>
<link href="../favicon.png" rel="icon" type="image/png">
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-html/tabby.min.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-contrib/foldbox/foldbox.css" rel="stylesheet"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.4.542">

  <meta name="author" content="Dr.&nbsp;Silvio Fanzon">
  <meta name="author" content="Dr.&nbsp;John Fry">
  <title>Statistical Models</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
    /* CSS for citations */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
      margin-bottom: 0em;
    }
    .hanging-indent div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }  </style>
  <link rel="stylesheet" href="../site_libs/revealjs/dist/theme/quarto.css">
  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css">
  <link href="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    padding-bottom: 0.5rem;
    margin-bottom: 0;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
  <style>
  .Axiom {
    --color1: #f4cce0;
    --color2: #db4d92;
  }
  .Remark {
    --color1: #bce5de;
    --color2: #21aa93;
  }
  .Example {
    --color1: #bce5de;
    --color2: #21aa93;
  }
  .Notation {
    --color1: #c6e6ed;
    --color2: #1995ad;
  }
  .Conjecture {
    --color1: #f4cce0;
    --color2: #db4d92;
  }
  .TODO {
    --color1: #e7b1b4;
    --color2: #8c3236;
  }
  .Proposition {
    --color1: #f4cce0;
    --color2: #db4d92;
  }
  .Idea {
    --color1: #f4cce0;
    --color2: #db4d92;
  }
  .Important {
    --color1: #f4cce0;
    --color2: #db4d92;
  }
  .DONE {
    --color1: #cce7b1;
    --color2: #86b754;
  }
  .Theorem {
    --color1: #f4cce0;
    --color2: #db4d92;
  }
  .Proof {
    --color1: #f1f1f2;
    --color2: #c0c0c1;
  }
  .Warning {
    --color1: #f4cce0;
    --color2: #db4d92;
  }
  .Problem {
    --color1: #f4cce0;
    --color2: #db4d92;
  }
  .Lemma {
    --color1: #f4cce0;
    --color2: #db4d92;
  }
  .Definition {
    --color1: #c6e6ed;
    --color2: #1995ad;
  }
  .Question {
    --color1: #f4cce0;
    --color2: #db4d92;
  }
  .Corollary {
    --color1: #f4cce0;
    --color2: #db4d92;
  }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Statistical Models</h1>
  <p class="subtitle">Lecture 11</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
<a href="https://www.silviofanzon.com">Dr.&nbsp;Silvio Fanzon</a> 
</div>
<div class="quarto-title-author-email">
<a href="mailto:S.Fanzon@hull.ac.uk">S.Fanzon@hull.ac.uk</a>
</div>
        <p class="quarto-title-affiliation">
            University of Hull
          </p>
    </div>
<div class="quarto-title-author">
<div class="quarto-title-author-name">
<a href="https://www.hull.ac.uk/staff-directory/john-fry">Dr.&nbsp;John Fry</a> 
</div>
<div class="quarto-title-author-email">
<a href="mailto:J.M.Fry@hull.ac.uk">J.M.Fry@hull.ac.uk</a>
</div>
        <p class="quarto-title-affiliation">
            University of Hull
          </p>
    </div>
</div>

</section>
<section>
<section id="part-3-multicollinearity" class="title-slide slide level1 center" data-background-color="#cc0164" data-visibility="uncounted">
<h1>Part 3: <br>Multicollinearity</h1>
<div class="footer">
<div color="#cc0164">

</div>
</div>
</section>
<section id="multicollinearity" class="slide level2 smaller">
<h2>Multicollinearity</h2>
<ul>
<li>The general linear regression model is</li>
</ul>
<p><span class="math display">
Y_i = \beta_1 z_{i1} + \beta_2 z_{i2} + \ldots + \beta_p z_{ip} + \varepsilon_i
</span></p>
<ul>
<li>Consider Assumption 6
<ul>
<li>The design matrix <span class="math inline">Z</span> is such that <span class="math display">
  Z^T Z  \, \text{ is invertible}
  </span></li>
</ul></li>
<li><strong>Multicollinearity:</strong> The violation of Assumption 6</li>
</ul>
<p><span class="math display">
\det(Z^T Z ) \, \approx  \, 0  \, \quad \implies \quad Z^T Z \, \text{ is (almost) not invertible}
</span></p>
</section>
<section id="the-nature-of-multicollinearity" class="slide level2 smaller">
<h2>The nature of Multicollinearity</h2>
<p><span class="math display">
\text{Multicollinearity = multiple (linear) relationships between the X-variables}
</span></p>
<ul>
<li>Multicollinearity arises when there is either
<ul>
<li><strong>exact</strong> linear relationship amongst the <span class="math inline">X</span>-variables</li>
<li><strong>approximate</strong> linear relationship amongst the <span class="math inline">X</span>-variables</li>
</ul></li>
</ul>
<p><br></p>
<p><strong><span class="math inline">X</span>-variables <em>inter-related</em></strong> <span class="math inline">\quad \implies \quad</span> <strong>hard to isolate individual influence on <span class="math inline">Y</span></strong></p>
</section>
<section id="example-of-multicollinear-data" class="slide level2 smaller">
<h2>Example of Multicollinear data</h2>
<div class="columns" style="display: flex !important; height: 90%;">
<div class="column" style="display: flex; justify-content: center; align-items: center;">
<ul>
<li><p>Perfect collinearity for <span class="math inline">Z_1</span> and <span class="math inline">Z_2</span></p>
<ul>
<li>because of exact linear relation <span class="math display">
  Z_2 = 5 Z_1
  </span></li>
</ul></li>
<li><p>No perfect collinearity for <span class="math inline">Z_1</span> and <span class="math inline">Z_3</span></p></li>
<li><p>But <span class="math inline">Z_3</span> is small perturbation of <span class="math inline">Z_2</span></p></li>
</ul>
</div><div class="column" style="display: flex; justify-content: center; align-items: center;">
<table>
<thead>
<tr class="header">
<th><span class="math inline">Z_1</span></th>
<th><span class="math inline">Z_2</span></th>
<th><span class="math inline">Z_3</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>10</td>
<td>50</td>
<td>52</td>
</tr>
<tr class="even">
<td>15</td>
<td>75</td>
<td>75</td>
</tr>
<tr class="odd">
<td>18</td>
<td>90</td>
<td>97</td>
</tr>
<tr class="even">
<td>24</td>
<td>120</td>
<td>129</td>
</tr>
<tr class="odd">
<td>30</td>
<td>150</td>
<td>152</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="example-of-multicollinear-data-1" class="slide level2 smaller">
<h2>Example of Multicollinear data</h2>
<div class="columns" style="display: flex !important; height: 90%;">
<div class="column" style="display: flex; justify-content: center; align-items: center;">
<ul>
<li>Approximate collinearity for <span class="math inline">Z_1, Z_3</span>
<ul>
<li>Correlation between <span class="math inline">Z_1</span> and <span class="math inline">Z_3</span> is almost <span class="math inline">1</span></li>
<li>There is approximate linear relation between <span class="math inline">Z_1</span> and <span class="math inline">Z_3</span> <span class="math display">
  Z_3 \, \approx \, 5 Z_1
  </span></li>
</ul></li>
<li><strong>Both instances qualify as multicollinearity</strong></li>
</ul>
</div><div class="column" style="display: flex; justify-content: center; align-items: center;">
<table>
<thead>
<tr class="header">
<th><span class="math inline">Z_1</span></th>
<th><span class="math inline">Z_2</span></th>
<th><span class="math inline">Z_3</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>10</td>
<td>50</td>
<td>52</td>
</tr>
<tr class="even">
<td>15</td>
<td>75</td>
<td>75</td>
</tr>
<tr class="odd">
<td>18</td>
<td>90</td>
<td>97</td>
</tr>
<tr class="even">
<td>24</td>
<td>120</td>
<td>129</td>
</tr>
<tr class="odd">
<td>30</td>
<td>150</td>
<td>152</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="example-of-multicollinear-data-2" class="slide level2 smaller">
<h2>Example of Multicollinear data</h2>
<div class="columns" style="display: flex !important; height: 90%;">
<div class="column" style="display: flex; justify-content: center; align-items: center;">
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Enter the data</span></span>
<span id="cb1-2"><a aria-hidden="true" tabindex="-1"></a>Z1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">18</span>, <span class="dv">24</span>, <span class="dv">30</span>)</span>
<span id="cb1-3"><a aria-hidden="true" tabindex="-1"></a>Z3 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">52</span>, <span class="dv">75</span>, <span class="dv">97</span>, <span class="dv">129</span>, <span class="dv">152</span>)</span>
<span id="cb1-4"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Compute correlation</span></span>
<span id="cb1-6"><a aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(Z1, Z3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9958817</code></pre>
</div>
</div>
</div><div class="column" style="display: flex; justify-content: center; align-items: center;">
<table>
<thead>
<tr class="header">
<th><span class="math inline">Z_1</span></th>
<th><span class="math inline">Z_2</span></th>
<th><span class="math inline">Z_3</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>10</td>
<td>50</td>
<td>52</td>
</tr>
<tr class="even">
<td>15</td>
<td>75</td>
<td>75</td>
</tr>
<tr class="odd">
<td>18</td>
<td>90</td>
<td>97</td>
</tr>
<tr class="even">
<td>24</td>
<td>120</td>
<td>129</td>
</tr>
<tr class="odd">
<td>30</td>
<td>150</td>
<td>152</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="consequences-of-multicollinearity" class="slide level2 smaller">
<h2>Consequences of Multicollinearity</h2>
<ul>
<li>Therefore multicollinearity means that
<ul>
<li>Predictors <span class="math inline">Z_j</span> are (approximately) linearly dependent</li>
<li>E.g. one can be written as (approximate) linear combination of the others</li>
</ul></li>
<li>Recall that the design matrix is</li>
</ul>
<p><span class="math display">
Z
=
\left(
\begin{array}{cccc}
z_{11}  &amp; z_{12} &amp; \ldots &amp; z_{ip} \\
z_{21}  &amp; z_{22} &amp; \ldots &amp; z_{2p} \\
\ldots  &amp; \ldots &amp; \ldots &amp; \ldots \\
z_{n1}  &amp; z_{n2} &amp; \ldots &amp; z_{np} \\
\end{array}
\right)
</span></p>
<ul>
<li>Note that <span class="math inline">Z</span> has <span class="math inline">p</span> columns</li>
</ul>
</section>
<section id="consequences-of-multicollinearity-1" class="slide level2 smaller">
<h2>Consequences of Multicollinearity</h2>
<ul>
<li>If at least one pair <span class="math inline">Z_i</span> and <span class="math inline">Z_j</span> is collinear (linearly dependent) then</li>
</ul>
<p><span class="math display">
{\rm rank} (Z) &lt; p
</span></p>
<ul>
<li>Hence</li>
</ul>
<p><span class="math display">
{\rm rank} \left(  Z^T Z  \right) &lt; p
</span></p>
<ul>
<li>Therefore the matrix</li>
</ul>
<p><span class="math display">
Z^T Z \,\, \text{ is NOT invertible}
</span></p>
</section>
<section id="consequences-of-multicollinearity-2" class="slide level2 smaller">
<h2>Consequences of Multicollinearity</h2>
<ul>
<li>This means the least-squares estimator is not well defined</li>
</ul>
<p><span class="math display">
\hat{\beta} = (Z^T Z)^{-1} Z^T y
</span></p>
<ul>
<li><p>In practice one never has exact Multicollinearity</p></li>
<li><p>In case of approximate Multicollinearity it holds that</p>
<ul>
<li>The matrix <span class="math inline">Z^T Z</span> can be inverted</li>
<li>The estimator <span class="math inline">\hat \beta</span> can be computed!</li>
<li>However the inversion is numerically instable</li>
</ul></li>
</ul>
</section>
<section id="consequences-of-multicollinearity-3" class="slide level2 smaller">
<h2>Consequences of Multicollinearity</h2>
<ul>
<li>Numerically instable means:
<ul>
<li><strong>We may not be able to trust the estimator <span class="math inline">\hat \beta</span></strong></li>
</ul></li>
</ul>
<p>This is because of:</p>
<ol type="1">
<li>Large estimated standard errors
<ul>
<li>Lack of precision associated with parameter estimtes</li>
<li>Wider confidence intervals</li>
<li>May affect hypothesis tests</li>
</ul></li>
<li>Correlated parameter estimates
<ul>
<li>Another potential source of errors</li>
<li>Potential numerical problems with computational routines</li>
</ul></li>
</ol>
</section>
<section id="why-are-estimated-standard-errors-large" class="slide level2 smaller">
<h2>Why are estimated standard errors large?</h2>
<ul>
<li>Recall formula of estimated standard error for <span class="math inline">\beta_j</span></li>
</ul>
<p><span class="math display">
\mathop{\mathrm{e.s.e.}}= \xi_{jj}^{1/2} \, S   \,, \qquad \quad S^2 = \frac{\mathop{\mathrm{RSS}}}{n-p}
</span></p>
<ul>
<li><p>The numbers <span class="math inline">\xi_{jj}</span> are diagonal entries of <span class="math inline">Z^T Z</span></p></li>
<li><p>Approximate Multicollinearity implies that</p>
<ul>
<li><span class="math inline">Z^T Z</span> is invertible</li>
<li>The inversion is numerically unstable</li>
</ul></li>
</ul>
</section>
<section id="why-are-estimated-standard-errors-large-1" class="slide level2 smaller">
<h2>Why are estimated standard errors large?</h2>
<ul>
<li>Numerically unstable inversion means that
<ul>
<li>Entries of <span class="math inline">(Z^T Z)^{-1}</span> might be very large</li>
<li>Therefore <span class="math inline">\xi_{jj}</span> might be very large</li>
</ul></li>
<li>As a consequence the estimated standard errors might be very large, since</li>
</ul>
<p><span class="math display">
\mathop{\mathrm{e.s.e.}}= \xi_{jj}^{1/2} S
</span></p>
<ul>
<li><strong>It becomes harder to reject incorrect hypotheses</strong></li>
</ul>
</section>
<section id="effect-of-multicollinearity-on-t-tests" class="slide level2 smaller">
<h2>Effect of Multicollinearity on t-tests</h2>
<ul>
<li>To test the null hypothesis that <span class="math inline">\beta_j = 0</span> we use <span class="math inline">t</span>-statistic</li>
</ul>
<p><span class="math display">
t = \frac{\hat{\beta}_j}{ \mathop{\mathrm{e.s.e.}}}
</span></p>
<ul>
<li><p>But multicollinearity increases the <span class="math inline">\mathop{\mathrm{e.s.e.}}</span></p></li>
<li><p>Therefore the t-statistic reduces in size:</p>
<ul>
<li>t-statistic will be smaller than it should</li>
<li>The p-values will be large <span class="math inline">p &gt; 0.05</span></li>
</ul></li>
</ul>
<p><strong>It becomes harder to reject incorrect hypotheses!</strong></p>
</section>
<section id="sources-of-multicollinearity" class="slide level2 smaller">
<h2>Sources of Multicollinearity</h2>
<ul>
<li><strong>The data collection method employed</strong>
<ul>
<li>Sampling over a limited range of values taken by the regressors in the population</li>
</ul></li>
<li><strong>Constraints on the model or population</strong>
<ul>
<li>E.g. variables such as income and house size may be interrelated</li>
</ul></li>
<li><strong>Model Specification</strong>
<ul>
<li>E.g. adding polynomial terms to a model when range of <span class="math inline">X</span>-variables is small</li>
</ul></li>
</ul>
</section>
<section id="sources-of-multicollinearity-1" class="slide level2 smaller">
<h2>Sources of Multicollinearity</h2>
<ul>
<li><strong>An over-determined model</strong>
<ul>
<li>Having too many <span class="math inline">X</span> variables compared to the number of observations</li>
</ul></li>
<li><strong>Common trends</strong>
<ul>
<li>E.g. variables such as consumption, income, wealth, etc may be correlated due to a dependence upon general economic trends and cycles</li>
</ul></li>
</ul>
<p><strong>Often can <em>know</em> in advance when you might experience Multicollinearity</strong></p>
</section>
<section id="practical-consequences-of-multicollinearity" class="slide level2 smaller">
<h2>Practical consequences of Multicollinearity</h2>
<ul>
<li>In practical problems look for something that <em>does not look quite right</em></li>
</ul>
<div id="Important*-1.1" class="Important">
<p></p><details class="Important fbx-simplebox fbx-default" open=""><summary><strong>Important</strong></summary><div><strong>Often see high <span class="math inline">R^2</span> values coupled with small t-values</strong><p></p>
</div></details>
</div>
<ul>
<li><strong>This is contradictory</strong>
<ul>
<li>High <span class="math inline">R^2</span> suggests model is good and explains a lot of the variation in <span class="math inline">Y</span></li>
<li>But if individual <span class="math inline">t</span>-statistics are small, this suggests <span class="math inline">\beta_j = 0</span></li>
<li>Hence individual <span class="math inline">X</span>-variables do not affect <span class="math inline">Y</span></li>
</ul></li>
</ul>
</section>
<section id="potential-signs-of-multicollinearity" class="slide level2 smaller">
<h2>Potential signs of Multicollinearity</h2>
<ol type="1">
<li><p><strong>High <span class="math inline">R^2</span> values couple with small t-values</strong></p></li>
<li><p><strong>Very large <span class="math inline">\mathop{\mathrm{e.s.e.}}</span></strong></p></li>
<li><p><strong>Numerical instabilities:</strong></p>
<ul>
<li>Parameter estimates <span class="math inline">\hat \beta_j</span> become very sensitive to small changes in the data</li>
<li>The <span class="math inline">\mathop{\mathrm{e.s.e.}}</span> become very sensitive to small changes in the data</li>
<li>Parameter estimates <span class="math inline">\hat \beta_j</span> <em>take the wrong sign</em> or otherwise <em>look strange</em></li>
<li>Parameter estimates may be highly correlated</li>
</ul></li>
</ol>
</section>
<section id="example-of-multicollinearity" class="slide level2 smaller">
<h2>Example of Multicollinearity</h2>
<ul>
<li><p>Consider the following illustrative example</p></li>
<li><p>Want to explain expenditure <span class="math inline">Y</span> in terms of</p>
<ul>
<li>income <span class="math inline">X_2</span></li>
<li>wealth <span class="math inline">X_3</span></li>
</ul></li>
</ul>
<div id="Important*-1.2" class="Important">
<details class="Important fbx-simplebox fbx-default" open=""><summary><strong>Important</strong></summary><div>
<p><strong>To detect Multicollinearity look out for</strong></p>
<ul>
<li>High <span class="math inline">R^2</span> value</li>
<li>coupled with low t-values</li>
</ul>
</div></details>
</div>
</section>
<section id="example-dataset" class="slide level2 smaller">
<h2>Example dataset</h2>
<div style="font-size: 0.90em">
<table>
<thead>
<tr class="header">
<th>Expenditure <span class="math inline">Y</span></th>
<th>Income <span class="math inline">X_2</span></th>
<th>Wealth <span class="math inline">X_3</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>70</td>
<td>80</td>
<td>810</td>
</tr>
<tr class="even">
<td>65</td>
<td>100</td>
<td>1009</td>
</tr>
<tr class="odd">
<td>90</td>
<td>120</td>
<td>1273</td>
</tr>
<tr class="even">
<td>95</td>
<td>140</td>
<td>1425</td>
</tr>
<tr class="odd">
<td>110</td>
<td>160</td>
<td>1633</td>
</tr>
<tr class="even">
<td>115</td>
<td>180</td>
<td>1876</td>
</tr>
<tr class="odd">
<td>120</td>
<td>200</td>
<td>2052</td>
</tr>
<tr class="even">
<td>140</td>
<td>220</td>
<td>2201</td>
</tr>
<tr class="odd">
<td>155</td>
<td>240</td>
<td>2435</td>
</tr>
<tr class="even">
<td>150</td>
<td>260</td>
<td>2686</td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="fit-the-regression-model-in-r" class="slide level2 smaller">
<h2>Fit the regression model in R</h2>
<ul>
<li>Code for this example is available here <a href="codes/multicollinearity.R">multicollinearity.R</a></li>
</ul>
<div class="sourceCode" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Enter data</span></span>
<span id="cb3-2"><a aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">70</span>, <span class="dv">65</span>, <span class="dv">90</span>, <span class="dv">95</span>, <span class="dv">110</span>, <span class="dv">115</span>, <span class="dv">120</span>, <span class="dv">140</span>, <span class="dv">155</span>, <span class="dv">150</span>)</span>
<span id="cb3-3"><a aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">80</span>, <span class="dv">100</span>, <span class="dv">120</span>, <span class="dv">140</span>, <span class="dv">160</span>, <span class="dv">180</span>, <span class="dv">200</span>, <span class="dv">220</span>, <span class="dv">240</span>, <span class="dv">260</span>)</span>
<span id="cb3-4"><a aria-hidden="true" tabindex="-1"></a>x3 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">810</span>, <span class="dv">1009</span>, <span class="dv">1273</span>, <span class="dv">1425</span>, <span class="dv">1633</span>, <span class="dv">1876</span>, <span class="dv">2052</span>, <span class="dv">2201</span>, <span class="dv">2435</span>, <span class="dv">2686</span>)</span>
<span id="cb3-5"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Fit model</span></span>
<span id="cb3-7"><a aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x2 <span class="sc">+</span> x3)</span>
<span id="cb3-8"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-9"><a aria-hidden="true" tabindex="-1"></a><span class="co"># We want to display only part of summary</span></span>
<span id="cb3-10"><a aria-hidden="true" tabindex="-1"></a><span class="co"># First capture the output into a vector</span></span>
<span id="cb3-11"><a aria-hidden="true" tabindex="-1"></a>temp <span class="ot">&lt;-</span> <span class="fu">capture.output</span>(<span class="fu">summary</span>(model))</span>
<span id="cb3-12"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-13"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Then print only the lines of interest</span></span>
<span id="cb3-14"><a aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste</span>(temp[<span class="dv">9</span><span class="sc">:</span><span class="dv">20</span>], <span class="at">collapse =</span> <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="section" class="slide level2 smaller">
<h2></h2>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)   
(Intercept) 24.77473    6.75250   3.669  0.00798 **
x2           0.94154    0.82290   1.144  0.29016   
x3          -0.04243    0.08066  -0.526  0.61509   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 6.808 on 7 degrees of freedom
Multiple R-squared:  0.9635,    Adjusted R-squared:  0.9531 
F-statistic:  92.4 on 2 and 7 DF,  p-value: 9.286e-06</code></pre>
</div>
</div>
<p><br></p>
<p><strong>Three basic statistics</strong></p>
<ul>
<li><span class="math inline">R^2</span> coefficient</li>
<li>t-statistics and related p-values</li>
<li>F-statistic and related p-value</li>
</ul>
</section>
<section id="interpreting-the-r-output" class="slide level2 smaller">
<h2>Interpreting the R output</h2>
<ol type="1">
<li><span class="math inline">R^2 = 0.9635</span>
<ul>
<li>Model explains a substantial amount of the variation (96.35%) in the data</li>
</ul></li>
</ol>
<p><br></p>
<ol start="2" type="1">
<li>F-statistic is
<ul>
<li><span class="math inline">F = 92.40196</span></li>
<li>Corresponding p-value is <span class="math inline">p = 9.286 \times 10^{-6}</span></li>
<li>There is evidence <span class="math inline">p&lt;0.05</span> that at least one between <em>income</em> and <em>wealth</em> affect expenditure</li>
</ul></li>
</ol>
</section>
<section id="interpreting-the-r-output-1" class="slide level2 smaller">
<h2>Interpreting the R output</h2>
<ol start="3" type="1">
<li>t-statistics
<ul>
<li>t-statistics for <em>income</em> is <span class="math inline">t = 1.144</span></li>
<li>Corresponding p-value is <span class="math inline">p = 0.29016</span></li>
<li>t-statistic for <em>wealth</em> is <span class="math inline">t = -0.526</span></li>
<li>Corresponding p-value is <span class="math inline">p = 0.61509</span></li>
<li>Both p-values are <span class="math inline">p &gt; 0.05</span></li>
<li>Therefore neither <em>income</em> nor <em>wealth</em> are individually statistically significant</li>
<li>This means regression parameters are <span class="math inline">\beta_2 = \beta_3 = 0</span></li>
</ul></li>
</ol>
<p><strong>Main red flag for Multicollinearity:</strong></p>
<ul>
<li>High <span class="math inline">R^2</span> value coupled with low t-values (corresponding to high p-values)</li>
</ul>
</section>
<section id="the-output-looks-strange" class="slide level2 smaller">
<h2>The output looks strange</h2>
<h3 id="there-are-many-contradictions">There are many contradictions</h3>
<ol type="1">
<li><p>High <span class="math inline">R^2</span> value suggests model is really good</p></li>
<li><p>However low t-values imply neither <em>income</em> nor <em>wealth</em> affect <em>expenditure</em></p></li>
<li><p>F-statistic is high, meaning that at least one between <em>income</em> nor <em>wealth</em> affect <em>expenditure</em></p></li>
<li><p>The <em>wealth</em> variable has the <em>wrong sign</em> (<span class="math inline">\hat \beta_3 &lt; 0</span>)</p>
<ul>
<li>This makes no sense: it is likely that <em>expenditure</em> will increase as <em>wealth</em> increases</li>
<li>Therefore we would expect <span class="math inline">\, \hat \beta_3 &gt; 0</span></li>
</ul></li>
</ol>
<p><strong>Multicollinearity is definitely present!</strong></p>
</section>
<section id="computing-the-correlation" class="slide level2 smaller">
<h2>Computing the correlation</h2>
<ul>
<li>For further confirmation of Multicollinearity compute correlation of <span class="math inline">X_2</span> and <span class="math inline">X_3</span></li>
</ul>
<div class="sourceCode" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(x2, x3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9989624</code></pre>
</div>
</div>
<ul>
<li>Correlation is almost 1: Variables <span class="math inline">X_2</span> and <span class="math inline">X_3</span> are very highly correlated</li>
</ul>
<p><strong>This once again confirms Multicollinearity is present</strong></p>
<p><br></p>
<p><strong>Conclusion:</strong> The variables <em>Income</em> and <em>Wealth</em> are highly correlated</p>
<ul>
<li>Impossible to isolate individual impact of either <em>Income</em> or <em>Wealth</em> upon <em>Expenditure</em></li>
</ul>
</section>
<section id="detection-of-multicollinearity" class="slide level2 smaller">
<h2>Detection of Multicollinearity</h2>
<p><strong>Klein’s rule of thumb:</strong> Multicollinearity will be a serious problem if:</p>
<ul>
<li>The <span class="math inline">R^2</span> obtained from regressing predictor variables <span class="math inline">X</span> is greater than the overall <span class="math inline">R^2</span> obtained by regressing <span class="math inline">Y</span> against all the <span class="math inline">X</span> variables</li>
</ul>
<p><strong>Example:</strong> In the <em>Expenditure</em> vs <em>Income</em> and <em>Wealth</em> dataset we have</p>
<ul>
<li><p>Regressing <span class="math inline">Y</span> against <span class="math inline">X_2</span> and <span class="math inline">X_3</span> gives <span class="math inline">R^2=0.9635</span></p></li>
<li><p>Regressing <span class="math inline">X_2</span> against <span class="math inline">X_3</span> gives <span class="math inline">R^2 = 0.9979</span></p></li>
</ul>
<p><strong>Klein’s rule of thumb suggests that Multicollinearity will be a serious problem</strong></p>
</section>
<section id="remedial-measures" class="slide level2 smaller">
<h2>Remedial measures</h2>
<h3 id="do-nothing">Do nothing</h3>
<ul>
<li><p>Multicollinearity is essentially a <strong>data-deficiency problem</strong></p></li>
<li><p>Sometimes we have no control over the dataset available</p></li>
<li><p>Important point:</p>
<ul>
<li>Doing nothing should only be an option in quantitative social sciences (e.g.&nbsp;finance, economics) where data is often difficult to collect</li>
<li>For scientific experiments (e.g.&nbsp;physics, chemistry) one should strive to collect good data</li>
</ul></li>
</ul>
</section>
<section id="remedial-measures-1" class="slide level2 smaller">
<h2>Remedial measures</h2>
<h3 id="acquire-newmore-data">Acquire new/more data</h3>
<ul>
<li><p><strong>Multicollinearity is a sample feature</strong></p></li>
<li><p>Possible that another sample involving the same variables will have less Multicollinearity</p></li>
<li><p>Acquiring more data might reduce severity of Multicollinearity</p></li>
<li><p>More data can be collected by either</p>
<ul>
<li>increasing the sample size or</li>
<li>including additional variables</li>
</ul></li>
</ul>
</section>
<section id="remedial-measures-2" class="slide level2 smaller">
<h2>Remedial measures</h2>
<h3 id="use-prior-information-about-some-parameters">Use prior information about some parameters</h3>
<ul>
<li><p>To do this properly would require advanced Bayesian statistical methods</p></li>
<li><p>This is beyond the scope of this module</p></li>
</ul>
</section>
<section id="remedial-measures-3" class="slide level2 smaller">
<h2>Remedial measures</h2>
<h3 id="rethinking-the-model">Rethinking the model</h3>
<ul>
<li>Sometimes a model chosen for empirical analysis is not carefully thought out
<ul>
<li>Some important variables may be omitted</li>
<li>The functional form of the model may have been incorrectly chosen</li>
</ul></li>
<li>Sometimes using more advanced statistical techniques may be required
<ul>
<li>Factor Analysis</li>
<li>Principal Components Analysis</li>
<li>Ridge Regression</li>
</ul></li>
</ul>
</section>
<section id="remedial-measures-4" class="slide level2 smaller">
<h2>Remedial measures</h2>
<h3 id="transformation-of-variables">Transformation of variables</h3>
<ul>
<li><p>Multicollinearity may be reduced by transforming variables</p></li>
<li><p>This may be possible in various different ways</p>
<ul>
<li>E.g. for time-series data one might consider forming a new model by taking first differences</li>
</ul></li>
<li><p>Further reading in Chapter 10 of <span class="citation" data-cites="gujarati_porter">[<a href="#/references" role="doc-biblioref" onclick="">1</a>]</span></p></li>
</ul>
</section>
<section id="remedial-measures-5" class="slide level2 smaller">
<h2>Remedial measures</h2>
<h3 id="dropping-variables">Dropping variables</h3>
<ul>
<li><p>Simplest approach to tackle Multicollinearity is to drop one or more of the collinear variables</p></li>
<li><p>Then one has to find the best combination of <span class="math inline">X</span> variables which reduces Multicollinearity</p></li>
<li><p>Such selection process can be aided by <strong>Stepwise regression</strong> (more later)</p></li>
</ul>
</section>
<section id="example-dropping-variables" class="slide level2 smaller">
<h2>Example: Dropping variables</h2>
<ul>
<li><p>Consider again the <em>Expenditure</em> vs <em>Income</em> and <em>Wealth</em> dataset</p></li>
<li><p>The variables <em>Income</em> and <em>Wealth</em> are highly correlated</p></li>
<li><p>Intuitively we expect both <em>Income</em> and <em>Wealth</em> to affect <em>Expenditure</em></p></li>
<li><p>Solution can be to drop either <em>Income</em> or <em>Wealth</em> variables</p>
<ul>
<li>We can then fit 2 separate models</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Fit expenditure as function of income</span></span>
<span id="cb7-2"><a aria-hidden="true" tabindex="-1"></a>model<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x2)</span>
<span id="cb7-3"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Fit expenditure as function of wealth</span></span>
<span id="cb7-5"><a aria-hidden="true" tabindex="-1"></a>model<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x3)</span>
<span id="cb7-6"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-7"><a aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model<span class="fl">.1</span>)</span>
<span id="cb7-8"><a aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model<span class="fl">.2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="expenditure-vs-income" class="slide level2 smaller">
<h2>Expenditure Vs Income</h2>
<div style="font-size: 0.90em">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 24.45455    6.41382   3.813  0.00514 ** 
x2           0.50909    0.03574  14.243 5.75e-07 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 6.493 on 8 degrees of freedom
Multiple R-squared:  0.9621,    Adjusted R-squared:  0.9573 
F-statistic: 202.9 on 1 and 8 DF,  p-value: 5.753e-07</code></pre>
</div>
</div>
</div>
<p><br></p>
<div style="font-size: 0.93em">
<ul>
<li><span class="math inline">R^ 2 = 0.9621</span> which is quite high</li>
<li>p-value for <span class="math inline">\beta_2</span> is <span class="math inline">p = 9.8 \times 10^{-7} &lt; 0.5 \quad \implies \quad</span> <em>Income</em> variable is significant</li>
<li>Estimate is <span class="math inline">\hat \beta_2 = 0.50909 &gt; 0</span></li>
</ul>
<p><strong>Strong evidence that <em>Expenditure</em> increases as <em>Income</em> increases</strong></p>
</div>
</section>
<section id="expenditure-vs-wealth" class="slide level2 smaller">
<h2>Expenditure Vs Wealth</h2>
<div style="font-size: 0.90em">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 24.411045   6.874097   3.551   0.0075 ** 
x3           0.049764   0.003744  13.292  9.8e-07 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 6.938 on 8 degrees of freedom
Multiple R-squared:  0.9567,    Adjusted R-squared:  0.9513 
F-statistic: 176.7 on 1 and 8 DF,  p-value: 9.802e-07</code></pre>
</div>
</div>
</div>
<p><br></p>
<div style="font-size: 0.93em">
<ul>
<li><span class="math inline">R^ 2 = 0.9567</span> which is quite high</li>
<li>p-value for <span class="math inline">\beta_2</span> is <span class="math inline">p = 9.8 \times 10^{-7} &lt; 0.5 \quad \implies \quad</span> <em>Wealth</em> variable is significant</li>
<li>Estimate is <span class="math inline">\hat \beta_2 = 0.049764 &gt; 0</span></li>
</ul>
<p><strong>Strong evidence that <em>Expenditure</em> increases as <em>Wealth</em> increases</strong></p>
</div>
</section>
<section id="example-conclusion" class="slide level2 smaller">
<h2>Example: Conclusion</h2>
<ul>
<li>We considered the simpler models
<ul>
<li><em>Expenditure</em> vs <em>Income</em></li>
<li><em>Expenditure</em> vs <em>Wealth</em></li>
</ul></li>
<li>Both models perform really well
<ul>
<li><em>Expenditure</em> increases as either <em>Income</em> or <em>Wealth</em> increase</li>
</ul></li>
<li>Multicollinearity effects disappeared after dropping either variable!</li>
</ul>
</section>
<section id="stepwise-regression" class="slide level2 smaller">
<h2>Stepwise regression</h2>
<ul>
<li><p>Stepwise regression: Method of comparing regression models</p></li>
<li><p>Involves iterative selection of predictor variables <span class="math inline">X</span> to use in the model</p></li>
<li><p>It can be achieved through</p>
<ul>
<li>Forward selection</li>
<li>Backward selection</li>
<li>Stepwise selection: Combination of Forward and Backward selection</li>
</ul></li>
</ul>
</section>
<section id="stepwise-regression-methods" class="slide level2 smaller">
<h2>Stepwise regression methods</h2>
<ol type="1">
<li><strong>Forward Selection</strong>
<ul>
<li>Start with the <strong>null model</strong> with only intercept <span class="math display">
Y = \beta_1 + \varepsilon
</span></li>
<li>Add each variable <span class="math inline">X_j</span> incrementally, testing for significance</li>
<li>Stop when no more variables are statistically significant</li>
</ul></li>
</ol>
<p><strong>Note:</strong> Significance criterion for <span class="math inline">X_j</span> is in terms of <strong>AIC</strong></p>
<ul>
<li>AIC is a measure of how well a model fits the data</li>
<li>AIC is an alternative to the coefficient of determination <span class="math inline">R^2</span></li>
<li>We will give details about AIC later</li>
</ul>
</section>
<section id="stepwise-regression-methods-1" class="slide level2 smaller">
<h2>Stepwise regression methods</h2>
<ol start="2" type="1">
<li><strong>Backward Selection</strong>
<ul>
<li>Start with the <strong>full model</strong> <span class="math display">
Y = \beta_1 + \beta_2 X_{2}+ \ldots+\beta_p X_{p}+ \varepsilon
</span></li>
<li>Delete <span class="math inline">X_j</span> variables which are not significant</li>
<li>Stop when all the remaining variables are significant</li>
</ul></li>
</ol>
</section>
<section id="stepwise-regression-methods-2" class="slide level2 smaller">
<h2>Stepwise regression methods</h2>
<ol start="3" type="1">
<li><strong>Stepwise Selection</strong>
<ul>
<li>Start with the <strong>null model</strong> <span class="math display">
Y = \beta_1 + \varepsilon
</span></li>
<li>Add each variable <span class="math inline">X_j</span> incrementally, testing for significance</li>
<li>Each time a new variable <span class="math inline">X_j</span> is added, perform a Backward Selection step</li>
<li>Stop when all the remaining variables are significant</li>
</ul></li>
</ol>
<p><strong>Note:</strong> Stepwise Selection ensures that at each step all the variables are significant</p>
</section>
<section id="stepwise-regression-in-r" class="slide level2 smaller">
<h2>Stepwise regression in R</h2>
<ul>
<li>Suppose given
<ul>
<li>a data vector <span class="math inline">\, \texttt{y}</span></li>
<li>predictors data <span class="math inline">\, \texttt{x2}, \texttt{x3}, \ldots, \texttt{xp}</span></li>
</ul></li>
</ul>
<p><br></p>
<ul>
<li>Begin by fitting the null and full regression models</li>
</ul>
<div class="sourceCode" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the null model</span></span>
<span id="cb10-2"><a aria-hidden="true" tabindex="-1"></a>null.model <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> <span class="dv">1</span>)</span>
<span id="cb10-3"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the full model</span></span>
<span id="cb10-5"><a aria-hidden="true" tabindex="-1"></a>full.model <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x2 <span class="sc">+</span> x3 <span class="sc">+</span> ... <span class="sc">+</span> xp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="stepwise-regression-in-r-1" class="slide level2 smaller">
<h2>Stepwise regression in R</h2>
<ul>
<li>There are 2 basic differences depending on whether you are doing
<ul>
<li>Forward selection or Stepwise selection: Start with <strong>null model</strong></li>
<li>Backward selection: Start with <strong>full model</strong></li>
</ul></li>
</ul>
<p><br></p>
<ul>
<li>The command for <em>Stepwise selection</em> is</li>
</ul>
<div class="sourceCode" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Stepwise selection</span></span>
<span id="cb11-2"><a aria-hidden="true" tabindex="-1"></a>best.model <span class="ot">&lt;-</span> <span class="fu">step</span>(null.model, </span>
<span id="cb11-3"><a aria-hidden="true" tabindex="-1"></a>                   <span class="at">direction =</span> <span class="st">"both"</span>, </span>
<span id="cb11-4"><a aria-hidden="true" tabindex="-1"></a>                   <span class="at">scope =</span> <span class="fu">formula</span>(full.model))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="stepwise-regression-in-r-2" class="slide level2 smaller">
<h2>Stepwise regression in R</h2>
<ul>
<li>The command for <em>Forward selection</em> is</li>
</ul>
<div class="sourceCode" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Forward selection</span></span>
<span id="cb12-2"><a aria-hidden="true" tabindex="-1"></a>best.model <span class="ot">&lt;-</span> <span class="fu">step</span>(null.model, </span>
<span id="cb12-3"><a aria-hidden="true" tabindex="-1"></a>                   <span class="at">direction =</span> <span class="st">"forward"</span>, </span>
<span id="cb12-4"><a aria-hidden="true" tabindex="-1"></a>                   <span class="at">scope =</span> <span class="fu">formula</span>(full.model))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><br></p>
<ul>
<li>The command for <em>Backward selection</em> is</li>
</ul>
<div class="sourceCode" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Backward selection</span></span>
<span id="cb13-2"><a aria-hidden="true" tabindex="-1"></a>best.model <span class="ot">&lt;-</span> <span class="fu">step</span>(full.model, </span>
<span id="cb13-3"><a aria-hidden="true" tabindex="-1"></a>                   <span class="at">direction =</span> <span class="st">"backward"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="stepwise-regression-in-r-3" class="slide level2 smaller">
<h2>Stepwise regression in R</h2>
<ul>
<li>The model selected by <em>Stepwise regression</em> is saved in
<ul>
<li><span class="math inline">\texttt{best.model}</span></li>
</ul></li>
</ul>
<p><br></p>
<ul>
<li>To check which model is best, just print the summary and read first 2 lines</li>
</ul>
<div class="sourceCode" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(best.model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="example-longley-dataset" class="slide level2 smaller">
<h2>Example: Longley dataset</h2>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>      GNP Unemployed Armed.Forces Population Year Employed
1 234.289      235.6        159.0    107.608 1947   60.323
2 259.426      232.5        145.6    108.632 1948   61.122
3 258.054      368.2        161.6    109.773 1949   60.171</code></pre>
</div>
</div>
<p><strong>Goal:</strong> Explain the number of <em>Employed</em> people <span class="math inline">Y</span> in the US in terms of</p>
<ul>
<li><span class="math inline">X_2</span> <em>GNP</em> Gross National Product</li>
<li><span class="math inline">X_3</span> number of <em>Unemployed</em></li>
<li><span class="math inline">X_4</span> number of people in the <em>Armed Forces</em></li>
<li><span class="math inline">X_5</span> <em>non-institutionalised Population</em> <span class="math inline">\geq</span> age 14 (not in care of insitutions)</li>
<li><span class="math inline">X_6</span> <em>Years</em> from 1947 to 1962</li>
</ul>
</section>
<section id="reading-in-the-data" class="slide level2 smaller">
<h2>Reading in the data</h2>
<ul>
<li><p>Code for this example is available here <a href="codes/longley_stepwise.R">longley_stepwise.R</a></p></li>
<li><p>Longley dataset available here <a href="datasets/longley.txt">longley.txt</a></p></li>
<li><p>Download the data file and place it in current working directory</p></li>
</ul>
<div class="sourceCode" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Read data file</span></span>
<span id="cb16-2"><a aria-hidden="true" tabindex="-1"></a>longley <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="at">file =</span> <span class="st">"longley.txt"</span>,</span>
<span id="cb16-3"><a aria-hidden="true" tabindex="-1"></a>                      <span class="at">header =</span> <span class="cn">TRUE</span>)</span>
<span id="cb16-4"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-5"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Store columns in vectors</span></span>
<span id="cb16-6"><a aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> longley[ , <span class="dv">1</span>]</span>
<span id="cb16-7"><a aria-hidden="true" tabindex="-1"></a>x3 <span class="ot">&lt;-</span> longley[ , <span class="dv">2</span>]</span>
<span id="cb16-8"><a aria-hidden="true" tabindex="-1"></a>x4 <span class="ot">&lt;-</span> longley[ , <span class="dv">3</span>]</span>
<span id="cb16-9"><a aria-hidden="true" tabindex="-1"></a>x5 <span class="ot">&lt;-</span> longley[ , <span class="dv">4</span>]</span>
<span id="cb16-10"><a aria-hidden="true" tabindex="-1"></a>x6 <span class="ot">&lt;-</span> longley[ , <span class="dv">5</span>]</span>
<span id="cb16-11"><a aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> longley[ , <span class="dv">6</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="detecting-multicollinearity" class="slide level2 smaller">
<h2>Detecting Multicollinearity</h2>
<ul>
<li>Fit the multiple regression model including all predictors</li>
</ul>
<p><span class="math display">
Y = \beta_1 + \beta_2 \, X_2 + \beta_3 \, X_3 + \beta_4 \, X_4 + \beta_5 \, X_5
    + \beta_6 \, X_6 + \varepsilon
</span></p>
<p><br></p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Fit multiple regression model</span></span>
<span id="cb17-2"><a aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x2 <span class="sc">+</span> x3 <span class="sc">+</span> x4 <span class="sc">+</span> x5 <span class="sc">+</span> x6)</span>
<span id="cb17-3"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Print summary</span></span>
<span id="cb17-5"><a aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="section-1" class="slide level2 smaller">
<h2></h2>
<div class="columns">
<div class="column" style="width:100%;">
<p><img data-src="images/longley_output_4.png" style="width:72.0%"></p>
</div>
</div>
<ul>
<li>Fitting the full model gives
<ul>
<li>High <span class="math inline">R^2</span> value</li>
<li>Low <span class="math inline">t</span>-values (and high p-values) for <span class="math inline">X_2</span> and <span class="math inline">X_5</span></li>
</ul></li>
<li>These are signs that we might have a problem with Multicollinearity</li>
</ul>
</section>
<section id="section-2" class="slide level2 smaller">
<h2></h2>
<ul>
<li>To further confirm Multicollinearity we can look at the correlation matrix
<ul>
<li>We can use function <span class="math inline">\, \texttt{cor}</span> directly on first 5 columns of data-frame <span class="math inline">\,\texttt{longley}</span></li>
<li>We look only at correlations larger than <span class="math inline">0.9</span></li>
</ul></li>
</ul>
<div class="sourceCode" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Return correlations larger than 0.9</span></span>
<span id="cb18-2"><a aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(longley[ , <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]) <span class="sc">&gt;</span> <span class="fl">0.9</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>               GNP Unemployed Armed.Forces Population  Year
GNP           TRUE      FALSE        FALSE       TRUE  TRUE
Unemployed   FALSE       TRUE        FALSE      FALSE FALSE
Armed.Forces FALSE      FALSE         TRUE      FALSE FALSE
Population    TRUE      FALSE        FALSE       TRUE  TRUE
Year          TRUE      FALSE        FALSE       TRUE  TRUE</code></pre>
</div>
</div>
<p><br></p>
<ul>
<li>Hence the following pairs are highly correlated (correlation <span class="math inline">\, &gt; 0.9</span>) <span class="math display">
X_2 \,\, \text{and} \,\, X_5 \qquad \quad
X_2 \,\, \text{and} \,\, X_6 \qquad \quad
X_4 \,\, \text{and} \,\, X_6
</span></li>
</ul>
</section>
<section id="stepwise-regression-1" class="slide level2 smaller">
<h2>Stepwise regression</h2>
<ul>
<li><strong>Goal:</strong> Want to find best variables which, at the same time
<ul>
<li>Explain <em>Employment</em> variable <span class="math inline">Y</span></li>
<li>Reduce Multicollinearity</li>
</ul></li>
<li><strong>Method:</strong> We use <em>Stepwise regression</em></li>
</ul>
<p><br></p>
<ul>
<li>Start by by fitting the null and full regression models</li>
</ul>
<div class="sourceCode" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the null model</span></span>
<span id="cb20-2"><a aria-hidden="true" tabindex="-1"></a>null.model <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> <span class="dv">1</span>)</span>
<span id="cb20-3"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-4"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the full model</span></span>
<span id="cb20-5"><a aria-hidden="true" tabindex="-1"></a>full.model <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x2 <span class="sc">+</span> x3 <span class="sc">+</span> x4 <span class="sc">+</span> x5 <span class="sc">+</span> x6)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="stepwise-regression-2" class="slide level2 smaller">
<h2>Stepwise regression</h2>
<ul>
<li>Perform Stepwise regression by
<ul>
<li>Forward selection, Backward selection, Stepwise selection</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Forward selection</span></span>
<span id="cb21-2"><a aria-hidden="true" tabindex="-1"></a>best.model<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">step</span>(null.model, </span>
<span id="cb21-3"><a aria-hidden="true" tabindex="-1"></a>                    <span class="at">direction =</span> <span class="st">"forward"</span>, </span>
<span id="cb21-4"><a aria-hidden="true" tabindex="-1"></a>                    <span class="at">scope =</span> <span class="fu">formula</span>(full.model))</span>
<span id="cb21-5"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-6"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Backward selection</span></span>
<span id="cb21-7"><a aria-hidden="true" tabindex="-1"></a>best.model<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">step</span>(full.model, </span>
<span id="cb21-8"><a aria-hidden="true" tabindex="-1"></a>                    <span class="at">direction =</span> <span class="st">"backward"</span>)</span>
<span id="cb21-9"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-10"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Stepwise selection</span></span>
<span id="cb21-11"><a aria-hidden="true" tabindex="-1"></a>best.model<span class="fl">.3</span> <span class="ot">&lt;-</span> <span class="fu">step</span>(null.model, </span>
<span id="cb21-12"><a aria-hidden="true" tabindex="-1"></a>                    <span class="at">direction =</span> <span class="st">"both"</span>,</span>
<span id="cb21-13"><a aria-hidden="true" tabindex="-1"></a>                    <span class="at">scope =</span> <span class="fu">formula</span>(full.model))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="stepwise-regression-3" class="slide level2 smaller">
<h2>Stepwise regression</h2>
<ul>
<li>The best models for the 3 Stepwise regression methods are stored in
<ul>
<li><span class="math inline">\texttt{best.model.1}, \,\, \texttt{best.model.3}, \,\,\texttt{best.model.3}</span></li>
</ul></li>
<li>Print the summary for each model obtained</li>
</ul>
<div class="sourceCode" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Print summary of each model</span></span>
<span id="cb22-2"><a aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(best.model.x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li><strong>Conclusion:</strong>In this simple example all three approaches agree and select a model with the variables <span class="math inline">X_2</span>, <span class="math inline">X_3</span>, <span class="math inline">X_4</span> and <span class="math inline">X_6</span> (no <span class="math inline">X_5</span> term)</li>
</ul>
</section></section>
<section>
<section id="part-4-stepwise-regression-and-overfitting" class="title-slide slide level1 center" data-background-color="#cc0164" data-visibility="uncounted">
<h1>Part 4: <br>Stepwise regression <br> and overfitting</h1>
<div class="footer">
<div color="#cc0164">

</div>
</div>
</section>
<section id="on-the-coefficient-of-determination-r2" class="slide level2 smaller">
<h2>On the coefficient of determination <span class="math inline">R^2</span></h2>
<ul>
<li>Recall the formula for the <span class="math inline">R^2</span> coefficient of determination</li>
</ul>
<p><span class="math display">
R^2 = 1 - \frac{\mathop{\mathrm{RSS}}}{\mathop{\mathrm{TSS}}}
</span></p>
<ul>
<li>We used <span class="math inline">R^2</span> to measure how well a regression model fits the data
<ul>
<li>Large <span class="math inline">R^2</span> implies good fit</li>
<li>Small <span class="math inline">R^2</span> implies bad fit</li>
</ul></li>
</ul>
</section>
<section id="revisiting-the-galileo-example" class="slide level2 smaller">
<h2>Revisiting the Galileo example</h2>
<p><strong>Drawback:</strong> <span class="math inline">R^2</span> increases when number of predictors increases</p>
<ul>
<li><p>We saw this phenomenon in the <strong>Galileo</strong> example in Lecture 10</p></li>
<li><p>Fitting the model <span class="math display">
  \rm{distance} = \beta_1 + \beta_2 \, \rm{height}  + \varepsilon
</span> yielded <span class="math inline">R^2 = 0.9264</span></p></li>
<li><p>In contrast the quadratic, cubic, and quartic models yielded, respectively <span class="math display">
R^2 = 0.9903 \,, \qquad R^2 = 0.9994 \,, \qquad
R^2 = 0.9998
</span></p></li>
<li><p>Fitting a higher degree polynomial gives higher <span class="math inline">R^2</span></p></li>
</ul>
</section>
<section id="revisiting-the-galileo-example-1" class="slide level2 smaller">
<h2>Revisiting the Galileo example</h2>
<p><strong>Conclusion:</strong> If the degree of the polynomial is sufficiently high, we will get <span class="math inline">R^2 = 1</span></p>
<ul>
<li>Indeed, there always exist a polynomial passing exactly through the data points</li>
</ul>
<p><span class="math display">
(\rm{height}_1, \rm{distance}_1) \,, \ldots , (\rm{height}_n, \rm{distance}_n)
</span></p>
<ul>
<li>For such polynomial model the predictions match the data perfectly</li>
</ul>
<p><span class="math display">
\hat y_i = y_i \,, \qquad \forall \,\, i = 1 , \ldots, n
</span></p>
<ul>
<li>Therefore we have</li>
</ul>
<p><span class="math display">
\mathop{\mathrm{RSS}}= \sum_{i=1}^n (y_i - \hat y_i )^2 = 0 \qquad \implies
\qquad R^2 = 1
</span></p>
</section>
<section id="overfitting-the-model" class="slide level2 smaller">
<h2>Overfitting the model</h2>
<p><strong>Warning:</strong> Adding increasingly higher number of parameters is not good</p>
<ul>
<li>It leads to a phenomenon called <strong>overfitting</strong>
<ul>
<li>The model fits the data very well</li>
<li>However the model does not make good predictions on unseen data</li>
</ul></li>
<li>We encountered this phenomenon in the <strong>Divorces</strong> example of Lecture 10</li>
</ul>
</section>
<section id="revisiting-the-divorces-example" class="slide level2 smaller">
<h2>Revisiting the Divorces example</h2>
<div class="column" style="width:45%;">
<p><br></p>
<ul>
<li><p>The best model seems to be Linear <span class="math display">
y = \beta_1 + \beta_2 x + \varepsilon
</span></p></li>
<li><p>Linear model interpretation:</p>
<ul>
<li>The risk of divorce is decreasing in time</li>
<li>The risk peak in year 2 is explained by unusually low risk in year 1</li>
</ul></li>
</ul>
</div>
<div class="column" style="width:46%;">
<div class="cell">
<details class="code-fold">
<summary>Click here for full code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Divorces data</span></span>
<span id="cb23-2"><a aria-hidden="true" tabindex="-1"></a>year <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>,<span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>, <span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">20</span>, <span class="dv">25</span>, <span class="dv">30</span>)</span>
<span id="cb23-3"><a aria-hidden="true" tabindex="-1"></a>percent <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">3.51</span>, <span class="fl">9.5</span>, <span class="fl">8.91</span>, <span class="fl">9.35</span>, <span class="fl">8.18</span>, <span class="fl">6.43</span>, <span class="fl">5.31</span>, </span>
<span id="cb23-4"><a aria-hidden="true" tabindex="-1"></a>             <span class="fl">5.07</span>, <span class="fl">3.65</span>, <span class="fl">3.8</span>, <span class="fl">2.83</span>, <span class="fl">1.51</span>, <span class="fl">1.27</span>, <span class="fl">0.49</span>)</span>
<span id="cb23-5"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-6"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Fit linear model</span></span>
<span id="cb23-7"><a aria-hidden="true" tabindex="-1"></a>linear <span class="ot">&lt;-</span> <span class="fu">lm</span>(percent <span class="sc">~</span> year)</span>
<span id="cb23-8"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-9"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Fit order 6 model</span></span>
<span id="cb23-10"><a aria-hidden="true" tabindex="-1"></a>order_6 <span class="ot">&lt;-</span> <span class="fu">lm</span>(percent <span class="sc">~</span> year  <span class="sc">+</span> <span class="fu">I</span>( year<span class="sc">^</span><span class="dv">2</span> ) <span class="sc">+</span> <span class="fu">I</span>( year<span class="sc">^</span><span class="dv">3</span> ) <span class="sc">+</span> </span>
<span id="cb23-11"><a aria-hidden="true" tabindex="-1"></a>                                <span class="fu">I</span>( year<span class="sc">^</span><span class="dv">4</span> ) <span class="sc">+</span> <span class="fu">I</span>( year<span class="sc">^</span><span class="dv">5</span> ) <span class="sc">+</span></span>
<span id="cb23-12"><a aria-hidden="true" tabindex="-1"></a>                                <span class="fu">I</span>( year<span class="sc">^</span><span class="dv">6</span> ))</span>
<span id="cb23-13"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-14"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Scatter plot of data</span></span>
<span id="cb23-15"><a aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(year, percent, <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">ylab =</span> <span class="st">""</span>, <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">cex =</span> <span class="dv">2</span>)</span>
<span id="cb23-16"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-17"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Add labels</span></span>
<span id="cb23-18"><a aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(<span class="st">"Years of marriage"</span>, <span class="at">side =</span> <span class="dv">1</span>, <span class="at">line =</span> <span class="dv">3</span>, <span class="at">cex =</span> <span class="fl">2.1</span>)</span>
<span id="cb23-19"><a aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(<span class="st">"Risk of divorce by adultery"</span>, <span class="at">side =</span> <span class="dv">2</span>, <span class="at">line =</span> <span class="fl">2.5</span>, <span class="at">cex =</span> <span class="fl">2.1</span>)</span>
<span id="cb23-20"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-21"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Plot Linear Vs Quadratic</span></span>
<span id="cb23-22"><a aria-hidden="true" tabindex="-1"></a>polynomial <span class="ot">&lt;-</span> <span class="fu">Vectorize</span>(<span class="cf">function</span>(x, ps) {</span>
<span id="cb23-23"><a aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(ps)</span>
<span id="cb23-24"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>(ps<span class="sc">*</span>x<span class="sc">^</span>(<span class="dv">1</span><span class="sc">:</span>n<span class="dv">-1</span>))</span>
<span id="cb23-25"><a aria-hidden="true" tabindex="-1"></a>}, <span class="st">"x"</span>)</span>
<span id="cb23-26"><a aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">polynomial</span>(x, <span class="fu">coef</span>(linear)), <span class="at">add=</span><span class="cn">TRUE</span>, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb23-27"><a aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">polynomial</span>(x, <span class="fu">coef</span>(order_6)), <span class="at">add=</span><span class="cn">TRUE</span>, <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">lwd =</span> <span class="dv">3</span>)</span>
<span id="cb23-28"><a aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topright"</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"Linear"</span>, <span class="st">"Order 6"</span>), </span>
<span id="cb23-29"><a aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"blue"</span>), <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">cex =</span> <span class="dv">3</span>, <span class="at">lwd =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="lecture_11_temp_files/figure-revealjs/unnamed-chunk-8-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="revisiting-the-divorces-example-1" class="slide level2 smaller">
<h2>Revisiting the Divorces example</h2>
<div class="column" style="width:45%;">
<p><br></p>
<ul>
<li>Fitting <em>Order 6</em> polynomial yields better results
<ul>
<li>The coefficient <span class="math inline">R^2</span> decreases (of course!)</li>
<li>F-test for model comparison prefers <em>Order 6</em> model to the linear one</li>
</ul></li>
<li>Statistically <em>Order 6</em> model is better than <em>Linear</em> model</li>
</ul>
</div>
<div class="column" style="width:46%;">
<div class="cell">
<details class="code-fold">
<summary>Click here for full code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Divorces data</span></span>
<span id="cb24-2"><a aria-hidden="true" tabindex="-1"></a>year <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>,<span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>, <span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">20</span>, <span class="dv">25</span>, <span class="dv">30</span>)</span>
<span id="cb24-3"><a aria-hidden="true" tabindex="-1"></a>percent <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">3.51</span>, <span class="fl">9.5</span>, <span class="fl">8.91</span>, <span class="fl">9.35</span>, <span class="fl">8.18</span>, <span class="fl">6.43</span>, <span class="fl">5.31</span>, </span>
<span id="cb24-4"><a aria-hidden="true" tabindex="-1"></a>             <span class="fl">5.07</span>, <span class="fl">3.65</span>, <span class="fl">3.8</span>, <span class="fl">2.83</span>, <span class="fl">1.51</span>, <span class="fl">1.27</span>, <span class="fl">0.49</span>)</span>
<span id="cb24-5"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-6"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Fit linear model</span></span>
<span id="cb24-7"><a aria-hidden="true" tabindex="-1"></a>linear <span class="ot">&lt;-</span> <span class="fu">lm</span>(percent <span class="sc">~</span> year)</span>
<span id="cb24-8"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-9"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Fit order 6 model</span></span>
<span id="cb24-10"><a aria-hidden="true" tabindex="-1"></a>order_6 <span class="ot">&lt;-</span> <span class="fu">lm</span>(percent <span class="sc">~</span> year  <span class="sc">+</span> <span class="fu">I</span>( year<span class="sc">^</span><span class="dv">2</span> ) <span class="sc">+</span> <span class="fu">I</span>( year<span class="sc">^</span><span class="dv">3</span> ) <span class="sc">+</span> </span>
<span id="cb24-11"><a aria-hidden="true" tabindex="-1"></a>                                <span class="fu">I</span>( year<span class="sc">^</span><span class="dv">4</span> ) <span class="sc">+</span> <span class="fu">I</span>( year<span class="sc">^</span><span class="dv">5</span> ) <span class="sc">+</span></span>
<span id="cb24-12"><a aria-hidden="true" tabindex="-1"></a>                                <span class="fu">I</span>( year<span class="sc">^</span><span class="dv">6</span> ))</span>
<span id="cb24-13"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-14"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Scatter plot of data</span></span>
<span id="cb24-15"><a aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(year, percent, <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">ylab =</span> <span class="st">""</span>, <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">cex =</span> <span class="dv">2</span>)</span>
<span id="cb24-16"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-17"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Add labels</span></span>
<span id="cb24-18"><a aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(<span class="st">"Years of marriage"</span>, <span class="at">side =</span> <span class="dv">1</span>, <span class="at">line =</span> <span class="dv">3</span>, <span class="at">cex =</span> <span class="fl">2.1</span>)</span>
<span id="cb24-19"><a aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(<span class="st">"Risk of divorce by adultery"</span>, <span class="at">side =</span> <span class="dv">2</span>, <span class="at">line =</span> <span class="fl">2.5</span>, <span class="at">cex =</span> <span class="fl">2.1</span>)</span>
<span id="cb24-20"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-21"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Plot Linear Vs Quadratic</span></span>
<span id="cb24-22"><a aria-hidden="true" tabindex="-1"></a>polynomial <span class="ot">&lt;-</span> <span class="fu">Vectorize</span>(<span class="cf">function</span>(x, ps) {</span>
<span id="cb24-23"><a aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(ps)</span>
<span id="cb24-24"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>(ps<span class="sc">*</span>x<span class="sc">^</span>(<span class="dv">1</span><span class="sc">:</span>n<span class="dv">-1</span>))</span>
<span id="cb24-25"><a aria-hidden="true" tabindex="-1"></a>}, <span class="st">"x"</span>)</span>
<span id="cb24-26"><a aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">polynomial</span>(x, <span class="fu">coef</span>(linear)), <span class="at">add=</span><span class="cn">TRUE</span>, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb24-27"><a aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">polynomial</span>(x, <span class="fu">coef</span>(order_6)), <span class="at">add=</span><span class="cn">TRUE</span>, <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">lwd =</span> <span class="dv">3</span>)</span>
<span id="cb24-28"><a aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topright"</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"Linear"</span>, <span class="st">"Order 6"</span>), </span>
<span id="cb24-29"><a aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"blue"</span>), <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">cex =</span> <span class="dv">3</span>, <span class="at">lwd =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="lecture_11_temp_files/figure-revealjs/unnamed-chunk-9-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="revisiting-the-divorces-example-2" class="slide level2 smaller">
<h2>Revisiting the Divorces example</h2>
<div class="column" style="width:45%;">
<ul>
<li>However, looking at the plot:
<ul>
<li><em>Order 6</em> model introduces unnatural spike at 27 years</li>
<li>This is a sign of <em>overfitting</em></li>
</ul></li>
<li>Question:
<ul>
<li><span class="math inline">R^2</span> coefficient and F-test are in favor of <em>Order 6</em> model</li>
<li>How do we rule out the <em>Order 6</em> model?</li>
</ul></li>
<li>Answer: We need a new measure for comparing regression models</li>
</ul>
</div>
<div class="column" style="width:46%;">
<div class="cell">
<details class="code-fold">
<summary>Click here for full code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Divorces data</span></span>
<span id="cb25-2"><a aria-hidden="true" tabindex="-1"></a>year <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>,<span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>, <span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">20</span>, <span class="dv">25</span>, <span class="dv">30</span>)</span>
<span id="cb25-3"><a aria-hidden="true" tabindex="-1"></a>percent <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">3.51</span>, <span class="fl">9.5</span>, <span class="fl">8.91</span>, <span class="fl">9.35</span>, <span class="fl">8.18</span>, <span class="fl">6.43</span>, <span class="fl">5.31</span>, </span>
<span id="cb25-4"><a aria-hidden="true" tabindex="-1"></a>             <span class="fl">5.07</span>, <span class="fl">3.65</span>, <span class="fl">3.8</span>, <span class="fl">2.83</span>, <span class="fl">1.51</span>, <span class="fl">1.27</span>, <span class="fl">0.49</span>)</span>
<span id="cb25-5"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-6"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Fit linear model</span></span>
<span id="cb25-7"><a aria-hidden="true" tabindex="-1"></a>linear <span class="ot">&lt;-</span> <span class="fu">lm</span>(percent <span class="sc">~</span> year)</span>
<span id="cb25-8"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-9"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Fit order 6 model</span></span>
<span id="cb25-10"><a aria-hidden="true" tabindex="-1"></a>order_6 <span class="ot">&lt;-</span> <span class="fu">lm</span>(percent <span class="sc">~</span> year  <span class="sc">+</span> <span class="fu">I</span>( year<span class="sc">^</span><span class="dv">2</span> ) <span class="sc">+</span> <span class="fu">I</span>( year<span class="sc">^</span><span class="dv">3</span> ) <span class="sc">+</span> </span>
<span id="cb25-11"><a aria-hidden="true" tabindex="-1"></a>                                <span class="fu">I</span>( year<span class="sc">^</span><span class="dv">4</span> ) <span class="sc">+</span> <span class="fu">I</span>( year<span class="sc">^</span><span class="dv">5</span> ) <span class="sc">+</span></span>
<span id="cb25-12"><a aria-hidden="true" tabindex="-1"></a>                                <span class="fu">I</span>( year<span class="sc">^</span><span class="dv">6</span> ))</span>
<span id="cb25-13"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-14"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Scatter plot of data</span></span>
<span id="cb25-15"><a aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(year, percent, <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">ylab =</span> <span class="st">""</span>, <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">cex =</span> <span class="dv">2</span>)</span>
<span id="cb25-16"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-17"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Add labels</span></span>
<span id="cb25-18"><a aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(<span class="st">"Years of marriage"</span>, <span class="at">side =</span> <span class="dv">1</span>, <span class="at">line =</span> <span class="dv">3</span>, <span class="at">cex =</span> <span class="fl">2.1</span>)</span>
<span id="cb25-19"><a aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(<span class="st">"Risk of divorce by adultery"</span>, <span class="at">side =</span> <span class="dv">2</span>, <span class="at">line =</span> <span class="fl">2.5</span>, <span class="at">cex =</span> <span class="fl">2.1</span>)</span>
<span id="cb25-20"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-21"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Plot Linear Vs Quadratic</span></span>
<span id="cb25-22"><a aria-hidden="true" tabindex="-1"></a>polynomial <span class="ot">&lt;-</span> <span class="fu">Vectorize</span>(<span class="cf">function</span>(x, ps) {</span>
<span id="cb25-23"><a aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(ps)</span>
<span id="cb25-24"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>(ps<span class="sc">*</span>x<span class="sc">^</span>(<span class="dv">1</span><span class="sc">:</span>n<span class="dv">-1</span>))</span>
<span id="cb25-25"><a aria-hidden="true" tabindex="-1"></a>}, <span class="st">"x"</span>)</span>
<span id="cb25-26"><a aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">polynomial</span>(x, <span class="fu">coef</span>(linear)), <span class="at">add=</span><span class="cn">TRUE</span>, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb25-27"><a aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">polynomial</span>(x, <span class="fu">coef</span>(order_6)), <span class="at">add=</span><span class="cn">TRUE</span>, <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">lwd =</span> <span class="dv">3</span>)</span>
<span id="cb25-28"><a aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topright"</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"Linear"</span>, <span class="st">"Order 6"</span>), </span>
<span id="cb25-29"><a aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"blue"</span>), <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">cex =</span> <span class="dv">3</span>, <span class="at">lwd =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="lecture_11_temp_files/figure-revealjs/unnamed-chunk-10-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="akaike-information-criterion-aic" class="slide level2 smaller">
<h2>Akaike information criterion (AIC)</h2>
<ul>
<li><p>The AIC is a number which measures how well a regression model fits the data</p></li>
<li><p>Also <span class="math inline">R^2</span> measures how well a regression model fits the data</p></li>
<li><p>The difference between AIC and <span class="math inline">R^2</span> is that AIC also <strong>accounts for overfitting</strong></p></li>
<li><p>The formal definition of AIC is</p></li>
</ul>
<p><span class="math display">
{\rm AIC} := 2p - 2 \log ( \hat{L} )
</span></p>
<ul>
<li><p><span class="math inline">p =</span> number of parameters in the model</p></li>
<li><p><span class="math inline">\hat{L} =</span> maximum value of the likelihood function</p></li>
</ul>
</section>
<section id="akaike-information-criterion-aic-1" class="slide level2 smaller">
<h2>Akaike information criterion (AIC)</h2>
<ul>
<li>In past lectures we have shown that for the general regression model</li>
</ul>
<p><span class="math display">
\ln(\hat L)=
-\frac{n}{2}\ln(2\pi) - \frac{n}{2}\ln(\hat\sigma^2) - \frac{1}{2\hat\sigma^2} \mathop{\mathrm{RSS}}\,, \qquad \hat \sigma^2 := \frac{\mathop{\mathrm{RSS}}}{n}
</span></p>
<ul>
<li>Therefore</li>
</ul>
<p><span class="math display">
\ln(\hat L)= - \frac{n}{2}  \log \left( \frac{\mathop{\mathrm{RSS}}}{n}  \right) + C
</span></p>
<ul>
<li><p><span class="math inline">C</span> is constant depending only on the number of sample points</p></li>
<li><p>Thus <span class="math inline">C</span> does not change if the data does not change</p></li>
</ul>
</section>
<section id="akaike-information-criterion-aic-2" class="slide level2 smaller">
<h2>Akaike information criterion (AIC)</h2>
<ul>
<li>We obtain the following equivalent formula for AIC</li>
</ul>
<p><span class="math display">
{\rm AIC} = 2p + n \log \left( \frac{ \mathop{\mathrm{RSS}}}{n} \right) - 2C
</span></p>
<ul>
<li>We now see that AIC accounts for
<ul>
<li><strong>Data fit:</strong> since the data fit term <span class="math inline">\mathop{\mathrm{RSS}}</span> is present</li>
<li><strong>Model complexity:</strong> Since the number of degrees of freedom <span class="math inline">p</span> is present</li>
</ul></li>
<li>Therefore a model with low AIC is such that:
<ol type="1">
<li>Model fits data well</li>
<li>Model is not too complex, preventing overfitting</li>
</ol></li>
<li>Conclusion: sometimes AIC is better than <span class="math inline">R^2</span> when comparing two models</li>
</ul>
</section>
<section id="stepwise-regression-and-aic" class="slide level2 smaller">
<h2>Stepwise regression and AIC</h2>
<ul>
<li><em>Stepwise regression</em> function in R uses AIC to compare models
<ul>
<li>the model with <strong>lowest AIC</strong> is selected</li>
</ul></li>
<li>Hence Stepwise regression outputs the model which, at the same time
<ol type="1">
<li>Best fits the given data</li>
<li>Prevents overfitting</li>
</ol></li>
<li><strong>Example:</strong> Apply Stepwise regression to <strong>divorces</strong> examples to compare
<ul>
<li>Linear model</li>
<li>Order 6 model</li>
</ul></li>
</ul>
</section>
<section id="example-divorces" class="slide level2 smaller">
<h2>Example: Divorces</h2>
<h3 id="the-dataset">The dataset</h3>
<ul>
<li>Code for this example is available here <a href="codes/divorces_stepwise.R">divorces_stepwise.R</a></li>
</ul>
<p><br></p>
<table style="width:100%;">
<colgroup>
<col style="width: 30%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"><strong>Years of Marriage</strong></th>
<th style="text-align: left;">1</th>
<th style="text-align: left;">2</th>
<th style="text-align: left;">3</th>
<th style="text-align: left;">4</th>
<th style="text-align: left;">5</th>
<th style="text-align: left;">6</th>
<th style="text-align: left;">7</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>% divorces adultery</strong></td>
<td style="text-align: left;">3.51</td>
<td style="text-align: left;">9.50</td>
<td style="text-align: left;">8.91</td>
<td style="text-align: left;">9.35</td>
<td style="text-align: left;">8.18</td>
<td style="text-align: left;">6.43</td>
<td style="text-align: left;">5.31</td>
</tr>
</tbody>
</table>
<p><br></p>
<table style="width:100%;">
<colgroup>
<col style="width: 30%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"><strong>Years of Marriage</strong></th>
<th style="text-align: left;">8</th>
<th style="text-align: left;">9</th>
<th style="text-align: left;">10</th>
<th style="text-align: left;">15</th>
<th style="text-align: left;">20</th>
<th style="text-align: left;">25</th>
<th style="text-align: left;">30</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>% divorces adultery</strong></td>
<td style="text-align: left;">5.07</td>
<td style="text-align: left;">3.65</td>
<td style="text-align: left;">3.80</td>
<td style="text-align: left;">2.83</td>
<td style="text-align: left;">1.51</td>
<td style="text-align: left;">1.27</td>
<td style="text-align: left;">0.49</td>
</tr>
</tbody>
</table>
</section>
<section id="fitting-the-null-model" class="slide level2 smaller">
<h2>Fitting the null model</h2>
<ul>
<li>First we import the data into R</li>
</ul>
<div class="sourceCode" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Divorces data</span></span>
<span id="cb26-2"><a aria-hidden="true" tabindex="-1"></a>year <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>,<span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>, <span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">20</span>, <span class="dv">25</span>, <span class="dv">30</span>)</span>
<span id="cb26-3"><a aria-hidden="true" tabindex="-1"></a>percent <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">3.51</span>, <span class="fl">9.5</span>, <span class="fl">8.91</span>, <span class="fl">9.35</span>, <span class="fl">8.18</span>, <span class="fl">6.43</span>, <span class="fl">5.31</span>, </span>
<span id="cb26-4"><a aria-hidden="true" tabindex="-1"></a>             <span class="fl">5.07</span>, <span class="fl">3.65</span>, <span class="fl">3.8</span>, <span class="fl">2.83</span>, <span class="fl">1.51</span>, <span class="fl">1.27</span>, <span class="fl">0.49</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>The null model is</li>
</ul>
<p><span class="math display">
{\rm percent} = \beta_1 + \varepsilon
</span></p>
<ul>
<li>Fit the null model with</li>
</ul>
<div class="sourceCode" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a aria-hidden="true" tabindex="-1"></a>null.model <span class="ot">&lt;-</span> <span class="fu">lm</span>(percent <span class="sc">~</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="fitting-the-full-model" class="slide level2 smaller">
<h2>Fitting the full model</h2>
<ul>
<li>The full model is the <em>Order 6</em> model</li>
</ul>
<p><span class="math display">
\rm{percent} = \beta_1 + \beta_2 \, {\rm year} +
\beta_3 \, {\rm year}^2 + \ldots + \beta_7 \, {\rm year}^6
</span></p>
<ul>
<li>Fit the full model with</li>
</ul>
<div class="sourceCode" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a aria-hidden="true" tabindex="-1"></a>full.model <span class="ot">&lt;-</span> <span class="fu">lm</span>(percent <span class="sc">~</span> year  <span class="sc">+</span> <span class="fu">I</span>( year<span class="sc">^</span><span class="dv">2</span> ) <span class="sc">+</span> <span class="fu">I</span>( year<span class="sc">^</span><span class="dv">3</span> ) <span class="sc">+</span> </span>
<span id="cb28-2"><a aria-hidden="true" tabindex="-1"></a>                                   <span class="fu">I</span>( year<span class="sc">^</span><span class="dv">4</span> ) <span class="sc">+</span> <span class="fu">I</span>( year<span class="sc">^</span><span class="dv">5</span> ) <span class="sc">+</span></span>
<span id="cb28-3"><a aria-hidden="true" tabindex="-1"></a>                                   <span class="fu">I</span>( year<span class="sc">^</span><span class="dv">6</span> ))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="stepwise-regression-4" class="slide level2 smaller">
<h2>Stepwise regression</h2>
<ul>
<li>We run stepwise regression and save the best model</li>
</ul>
<div class="sourceCode" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a aria-hidden="true" tabindex="-1"></a>best.model <span class="ot">&lt;-</span> <span class="fu">step</span>(null.model, </span>
<span id="cb29-2"><a aria-hidden="true" tabindex="-1"></a>                  <span class="at">direction =</span> <span class="st">"both"</span>, </span>
<span id="cb29-3"><a aria-hidden="true" tabindex="-1"></a>                  <span class="at">scope =</span> <span class="fu">formula</span>(full.model)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><br></p>
<ul>
<li>The best model is <em>Linear</em>, and not <em>Order 6</em>!</li>
</ul>
<div class="sourceCode" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(best.model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre class="verbatim"><code>
Call:
lm(formula = percent ~ year)

.....
</code></pre>
</section>
<section id="conclusions" class="slide level2 smaller">
<h2>Conclusions</h2>
<ul>
<li>Old conclusions:
<ul>
<li><em>Linear model</em> has lower <span class="math inline">R^2</span> than <em>Order 6 model</em></li>
<li>F-test for model selection chooses <em>Order 6 model</em> over <em>Linear model</em></li>
<li>Hence <em>Order 6 model</em> seems better than <em>Linear model</em></li>
</ul></li>
<li>New conclusions:
<ul>
<li><em>Order 6 model</em> is more complex than the <em>Linear model</em></li>
<li>In particular <em>Order 6 model</em> has higher AIC than the <em>Linear model</em></li>
<li>Stepwise regression chooses <em>Linear model</em> over <em>Order 6 model</em></li>
</ul></li>
<li><strong>Bottom line:</strong> The new findings are in line with our intuition:
<ul>
<li><em>Order 6</em> model overfits</li>
<li>Therefore the <em>Linear model</em> should be preferred</li>
</ul></li>
</ul>
</section></section>
<section>
<section id="part-5-dummy-variable-regression" class="title-slide slide level1 center" data-background-color="#cc0164" data-visibility="uncounted">
<h1>Part 5: <br>Dummy variable <br> regression</h1>
<div class="footer">
<div color="#cc0164">

</div>
</div>
</section>
<section id="references" class="slide level2 smaller scrollable">
<h2>References</h2>

<div class="quarto-auto-generated-content">
<div class="footer footer-default">
<p><a href="../index.html">Homepage</a> &nbsp;&nbsp;&nbsp;&nbsp; <a href="../license.html">License</a> &nbsp;&nbsp;&nbsp;&nbsp; <a href="https://www.silviofanzon.com/contact">Contact</a></p>
</div>
</div>
<div id="refs" class="references csl-bib-body" data-entry-spacing="0" role="list">
<div id="ref-gujarati_porter" class="csl-entry" role="listitem">
<div class="csl-left-margin">[1] </div><div class="csl-right-inline">Gujarati, D. N., Porter, D. C., Basic econometric, fifth edition, McGraw-Hill, 2009.</div>
</div>
</div>
</section></section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="../site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="../site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="../site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="../site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="../site_libs/revealjs/plugin/search/search.js"></script>
  <script src="../site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': true,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'fade',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        text: function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>